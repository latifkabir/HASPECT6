<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HASPECT6: HaSpect/THSsPlot.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HASPECT6
   </div>
   <div id="projectbrief">Hadron spectroscopy data analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3ca80ef9e5877ea9d11d1a324ddaa5cd.html">HaSpect</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">THSsPlot.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="THSsPlot_8C.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * \class THSsPlot</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * RooFit interface fit class</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * @example FitHSSimple.C</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="THSsPlot_8h.html">THSsPlot.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;TH1.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;TH2.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;TLegend.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span>      <span class="comment">// std::sort</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<a class="code" href="THSsPlot_8C.html#a870c8db1b5cf027fa6502f9b8be7b262">ClassImp</a>(<a class="code" href="classTHSsPlot.html">THSsPlot</a>);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#ab9df10513125f593de27fab517f754b5">   20</a></span>&#160;<a class="code" href="classTHSsPlot.html#ab9df10513125f593de27fab517f754b5">THSsPlot::THSsPlot</a>() : <a class="code" href="classTHSRooFit.html">THSRooFit</a>(),fSPlot(0),fWeights(0){</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0]=0;<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]=0; </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;};</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#ae50d6599953ca61cfdfe2d70a6d8e972">   24</a></span>&#160;<a class="code" href="classTHSsPlot.html#ab9df10513125f593de27fab517f754b5">THSsPlot::THSsPlot</a>(TString name) : <a class="code" href="classTHSRooFit.html">THSRooFit</a>(name){</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0]=0;<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]=0; </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#a47c6ead87909565231c427603b181323">   28</a></span>&#160;<a class="code" href="classTHSsPlot.html#ab9df10513125f593de27fab517f754b5">THSsPlot::THSsPlot</a>(TString name,RooWorkspace* ws) : <a class="code" href="classTHSRooFit.html">THSRooFit</a>(name,ws){</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0]=0;<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]=0; </div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#abdbcae97edd8aec36a7dd85d34f61817">   32</a></span>&#160;<a class="code" href="classTHSsPlot.html#ab9df10513125f593de27fab517f754b5">THSsPlot::THSsPlot</a>(<a class="code" href="classTHSsPlot.html">THSsPlot</a>* rf){</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="classTHSRooFit.html#a78f90f84a16da80b861be65e306f3a95">THSRooFit</a>(dynamic_cast&lt;THSRooFit*&gt;(rf));</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="comment">//copy constructor, but do not copy the data tree, load that explicitly</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <a class="code" href="classTHSsPlot.html#a3177e54ac4870317595d4b29e84afff7">fSaveWeights</a>=rf-&gt;<a class="code" href="classTHSsPlot.html#a3177e54ac4870317595d4b29e84afff7">fSaveWeights</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#a9d45c871453c0cb7ed2c428caf18d6f9">   38</a></span>&#160;<a class="code" href="classTHSsPlot.html#a9d45c871453c0cb7ed2c428caf18d6f9">THSsPlot::~THSsPlot</a>(){</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>) <span class="keyword">delete</span> <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">//  if(fSPlot) delete fSPlot; //crashes FitSavedBins with weights</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// Function to combine best fit pdfs into single PDF. </span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/// This allows sPlot fit to just be dependent on 2 yields</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/// where one is defined by fSingleSp and the other is the </span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/// sum of the rest.</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#ae214cc0a98022e2d0400168a28c1b5b0">   48</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#ae214cc0a98022e2d0400168a28c1b5b0">THSsPlot::MergeModelSpecies</a>(){</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSRooFit.html#acd8ca461329653b06b52953f1772197a">fWS</a>-&gt;pdf(<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>)) {cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::MergeModelSpecies() single Species not found &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>&lt;&lt;endl;}</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  RooArgList yields=<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  RooRealVar* sYield=(RooRealVar*)yields.find(<a class="code" href="classTHSRooFit.html#a92625a1c9d2b6dc2c1f68e9efffbdefc">fYld</a>+<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  yields.remove(*sYield);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  RooArgSet addpdfs = ((RooAddPdf*)<a class="code" href="classTHSRooFit.html#a26564e683834f3c10a3259f9613a29b6">fModel</a>)-&gt;pdfList();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  RooAbsPdf* sPdf=(RooAbsPdf*)addpdfs.find(<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  addpdfs.remove(*sPdf);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  RooAbsArg* icoef=0;   </div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">//sPlot Range change must recalculate yields for new range!</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0]!=<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]){</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    RooRealVar* var=((RooRealVar*)&amp;<a class="code" href="classTHSRooFit.html#aff08fd318d929eb3b6b3e5087b487879">fVariables</a>[0]);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    var-&gt;setRange(<span class="stringliteral">&quot;sRange&quot;</span>,<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0],<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    RooFIter pdfIter = addpdfs.fwdIterator();</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    RooAbsArg* ipdf=0;  </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    addpdfs.Print();</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    yields.Print();</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    Int_t iy=0;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">while</span>((ipdf=pdfIter.next())){        </div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      Double_t inte1=((RooAbsPdf*)ipdf)-&gt;createIntegral(<a class="code" href="classTHSRooFit.html#aff08fd318d929eb3b6b3e5087b487879">fVariables</a>)-&gt;getVal();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      Double_t inte2=((RooAbsPdf*)ipdf)-&gt;createIntegral(<a class="code" href="classTHSRooFit.html#aff08fd318d929eb3b6b3e5087b487879">fVariables</a>,RooFit::Range(<span class="stringliteral">&quot;sRange&quot;</span>))-&gt;getVal();</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      Double_t yd=((RooRealVar*)&amp;yields[iy])-&gt;getVal();</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      yd=yd*inte2/inte1;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::MergeModelSpecies() chenge rangeo of &quot;</span>&lt;&lt;((RooRealVar*)&amp;yields[iy])-&gt;GetName()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;((RooRealVar*)&amp;yields[iy])-&gt;getVal()&lt;&lt;<span class="stringliteral">&quot; by &quot;</span>&lt;&lt;inte2/inte1&lt;&lt;<span class="stringliteral">&quot; to &quot;</span>&lt;&lt;yd&lt;&lt;endl;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      ((RooRealVar*)&amp;yields[iy])-&gt;setVal(yd);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      iy++;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }   </div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//change yield of single pdf too</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    Double_t inte1=sPdf-&gt;createIntegral(<a class="code" href="classTHSRooFit.html#aff08fd318d929eb3b6b3e5087b487879">fVariables</a>)-&gt;getVal();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    Double_t inte2=sPdf-&gt;createIntegral(<a class="code" href="classTHSRooFit.html#aff08fd318d929eb3b6b3e5087b487879">fVariables</a>,RooFit::Range(<span class="stringliteral">&quot;sRange&quot;</span>))-&gt;getVal();</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    Double_t yd=sYield-&gt;getVal();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    yd=yd*inte2/inte1;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::MergeModelSpecies() chenge rangeo of &quot;</span>&lt;&lt;sYield-&gt;GetName()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;sYield-&gt;getVal()&lt;&lt;<span class="stringliteral">&quot; by &quot;</span>&lt;&lt;inte2/inte1&lt;&lt;<span class="stringliteral">&quot; to &quot;</span>&lt;&lt;yd&lt;&lt;endl;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   yields.setAttribAll(<span class="stringliteral">&quot;Constant&quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   RooAddPdf* rap=<span class="keyword">new</span> RooAddPdf(<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>+<span class="stringliteral">&quot;Merged&quot;</span>,<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>+<span class="stringliteral">&quot;Merged&quot;</span>,addpdfs,yields);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   rap-&gt;getParameters(*fData)-&gt;setAttribAll(<span class="stringliteral">&quot;Constant&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//fWS-&gt;import(*rap);</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">//remove all pdfs and add back single species and summed pdfs</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classTHSRooFit.html#a10726f4f43d8e6b4dac077c3901f5fe6">fPDFs</a>.releaseOwnership();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classTHSRooFit.html#a10726f4f43d8e6b4dac077c3901f5fe6">fPDFs</a>.removeAll();</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classTHSRooFit.html#a10726f4f43d8e6b4dac077c3901f5fe6">fPDFs</a>.add(*(sPdf));</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classTHSRooFit.html#a10726f4f43d8e6b4dac077c3901f5fe6">fPDFs</a>.add(*rap);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.releaseOwnership();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.removeAll();</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.add(*(sYield)); <span class="comment">//add back in single species yld</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">//construct new yield parameter for sum of other contributions</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  Double_t Ym=0; <span class="comment">//first sum the fitted yields</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">for</span>(Int_t iy=0;iy&lt;yields.getSize();iy++){</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    Ym+=((RooRealVar*)&amp;yields[iy])-&gt;getVal();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">//cout&lt;&lt;iy&lt;&lt;&quot;THSsPlot::MergeModelSpecies() CHECKING COEF &quot;&lt;&lt;((RooRealVar*)&amp;yields[iy])-&gt;getVal()&lt;&lt;endl; </span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;Ym &quot;</span>&lt;&lt; Ym&lt;&lt;endl;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  RooRealVar* ymerge=(RooRealVar*)<a class="code" href="classTHSRooFit.html#acd8ca461329653b06b52953f1772197a">fWS</a>-&gt;factory(<a class="code" href="classTHSRooFit.html#a92625a1c9d2b6dc2c1f68e9efffbdefc">fYld</a>+<span class="stringliteral">&quot;Merged[0,0,1]&quot;</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  (ymerge)-&gt;setMin(0,0);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  (ymerge)-&gt;setMax(0,2*Ym);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  (ymerge)-&gt;setVal(Ym);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.add(*ymerge);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  ymerge-&gt;Print();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::MergeModelSpecies() Print pdfs and yeilds&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classTHSRooFit.html#a10726f4f43d8e6b4dac077c3901f5fe6">fPDFs</a>.Print();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.Print();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classTHSRooFit.html#a1e03e43cf4d35342b6d05dab87e2dc03">TotalPDF</a>();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">////////////////////////////////////////</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">///Perform fit of yields to get sWeights</span></div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#aa1b883fbf2b829f9de071511f79b1c75">  121</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#aa1b883fbf2b829f9de071511f79b1c75">THSsPlot::sPlot</a>(){</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::sPlot() weights will be synchronised to branch &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetBranch(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>)&lt;&lt;endl;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">//Check if there is an ID branch for synchronisation</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">//check if ID branch exists</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>){</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetBranch(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>)){</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>=kTRUE;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::sPlot Loading ID branch data &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>&lt;&lt;endl;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">else</span> {cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::sPlot() warning No ID branch called will just use tree entry number. This means weights will fail to synchronise with initial tree if you cut events or use bins&quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>&lt;&lt;endl;}</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">//Option here to sum background contributions and fix relative yields</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>!=TString(<span class="stringliteral">&quot;&quot;</span>)) <a class="code" href="classTHSsPlot.html#ae214cc0a98022e2d0400168a28c1b5b0">MergeModelSpecies</a>();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">//Set all the model parameters to be constant, so only fitting the species yields</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">//calculate the sWeights </span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0]!=<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]){<span class="comment">//sub range set for sPlot fit, remake dataset</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   ((RooRealVar*)&amp;<a class="code" href="classTHSRooFit.html#aff08fd318d929eb3b6b3e5087b487879">fVariables</a>[0])-&gt;setRange(0,<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0],<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    RooArgSet dataVars(fVariables,<a class="code" href="classTHSRooFit.html#a759b3287f310a63a274140950ee01bfe">fAuxVars</a>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#aec780a4b9305b9af2f3ecfa284fbf2a6">fID</a>) dataVars.add(*<a class="code" href="classTHSRooFit.html#aec780a4b9305b9af2f3ecfa284fbf2a6">fID</a>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    RooDataSet* tmpData=0;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>) tmpData=<span class="keyword">new</span> RooDataSet(<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetName(),<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetTitle(),dataVars,RooFit::Import(*<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">else</span> tmpData=<span class="keyword">new</span> RooDataSet(<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;GetName(),<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;GetTitle(),(RooDataSet*)<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>,dataVars);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;SetName(<span class="stringliteral">&quot;Empty&quot;</span>);<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;reset();<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>=0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>=tmpData;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classTHSRooFit.html#a579eb4e03f1f6426d9a4342ab49b1dd0">SetDataWeight</a>();<span class="comment">//if weighted data reassign the weight</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classTHSRooFit.html#a2afc78baf86765b63ac69b77c59b22eb">fFiti</a>++;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#a78ad585293af9dd818f57a073e1b2742">fIsPlot</a>){</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="classTHSRooFit.html#ac1f6c72608abd297f1669b802bcf315c">PlotDataModel</a>();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      ((TCanvas*)<a class="code" href="classTHSRooFit.html#a930806846f61fb2b0a5e83b237415fbf">fCanvases</a>-&gt;Last())-&gt;SetTitle(Form(<span class="stringliteral">&quot;%s Model on new Range = %lf&quot;</span>,GetName(),<a class="code" href="classTHSRooFit.html#a14d7cf1b72fdd8b017633f039abd4983">fChi2</a>));</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  Info(<span class="stringliteral">&quot;THSsPlot::sPlot()&quot;</span>,<span class="stringliteral">&quot; about to start&quot;</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;sumEntries()&lt;1){cout&lt;&lt;<span class="stringliteral">&quot;Warning : void THSsPlot::sPlot() negative data entries no sPlot&quot;</span>&lt;&lt;endl;return ;}<span class="comment">//might be -ve with weights, in which case it may crash...also &lt;1</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classTHSRooFit.html#ac31264f23816924d7a99ace58b221799">fParameters</a>.setAttribAll(<span class="stringliteral">&quot;Constant&quot;</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ada0157b88164901f7d75997f57139cbb">fInWeights</a>) <span class="comment">//need to clone datset if want to draw results with in weights</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classTHSsPlot.html#adffb1c40ecdd267cdbcee64587f5a4cf">fSPlot</a> = <span class="keyword">new</span> RooStats::SPlot(<span class="stringliteral">&quot;splot_fit&quot;</span>, <span class="stringliteral">&quot;sPlot Fit&quot;</span>, *((RooDataSet*)<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>),<a class="code" href="classTHSRooFit.html#a26564e683834f3c10a3259f9613a29b6">fModel</a> ,<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>,RooArgSet(),kTRUE,kTRUE);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">//fSPlot = new RooStats::SPlot(&quot;splot_fit&quot;, &quot;sPlot Fit&quot;, *((RooDataSet*)fData),fModel ,fYields);</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classTHSsPlot.html#adffb1c40ecdd267cdbcee64587f5a4cf">fSPlot</a> = <span class="keyword">new</span> RooStats::SPlot(<span class="stringliteral">&quot;splot_fit&quot;</span>, <span class="stringliteral">&quot;sPlot Fit&quot;</span>, *((RooDataSet*)<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>),<a class="code" href="classTHSRooFit.html#a26564e683834f3c10a3259f9613a29b6">fModel</a> ,<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">//Check that the fit was succesfull</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  Double_t TotalYield=0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">for</span>(Int_t iy=0;iy&lt;<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.getSize();iy++)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    TotalYield+=((RooRealVar*)&amp;<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>[iy])-&gt;getVal();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="classTHSRooFit.html#a2afc78baf86765b63ac69b77c59b22eb">fFiti</a>++;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">if</span>(TotalYield&gt;0){ <span class="comment">//got some weights</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>=<span class="keyword">new</span> <a class="code" href="classTHSWeights.html">THSWeights</a>(<span class="stringliteral">&quot;HSsWeights&quot;</span>);<span class="comment">//initialise weights</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;SetTitle(GetName());</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a3c921186e360236cc0ae45f6299541f1">SetFile</a>(<a class="code" href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">fOutDir</a>+TString(<span class="stringliteral">&quot;Weights&quot;</span>)+GetName()+<span class="stringliteral">&quot;.root&quot;</span>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="classTHSsPlot.html#a43f38df9812e1fc171f1a35cc5510689">ExportWeights</a>();</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#a78ad585293af9dd818f57a073e1b2742">fIsPlot</a>){</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="classTHSRooFit.html#ac1f6c72608abd297f1669b802bcf315c">PlotDataModel</a>();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      ((TCanvas*)<a class="code" href="classTHSRooFit.html#a930806846f61fb2b0a5e83b237415fbf">fCanvases</a>-&gt;Last())-&gt;SetTitle(Form(<span class="stringliteral">&quot;%s sWeights Fit chi2 = %lf&quot;</span>,GetName(),<a class="code" href="classTHSRooFit.html#a14d7cf1b72fdd8b017633f039abd4983">fChi2</a>));</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">else</span> Warning(<span class="stringliteral">&quot;THSsPlot::sPlot()&quot;</span>,<span class="stringliteral">&quot; total weights 0, fit did not converge. Make sure the non-sweight fit to fix parameters was succesful. No weights will be assigned for these events&quot;</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#ac510207bfc684d2cfa58e68ce151c962">  183</a></span>&#160;Double_t <a class="code" href="classTHSsPlot.html#ac510207bfc684d2cfa58e68ce151c962">THSsPlot::GetSWeight</a>(Long64_t event,TString species){</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">//Note species should include the prepend fYld</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classTHSsPlot.html#adffb1c40ecdd267cdbcee64587f5a4cf">fSPlot</a>-&gt;GetSWeight(event,species);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#a43f38df9812e1fc171f1a35cc5510689">  188</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#a43f38df9812e1fc171f1a35cc5510689">THSsPlot::ExportWeights</a>(TString wmname){</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot:ExportWeights &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">//fWeights=new THSWeights(wmname);//initialise map</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  Int_t NSpecies=<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.getSize();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  TVectorD eventW(NSpecies); <span class="comment">//initialise weights vector</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//set name for each species, remove leading Yld_  </span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a32d4096c1a829e16345730d398703ea5">SetSpecies</a>(TString(<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.at(iw)-&gt;GetName()).Remove(0,4));</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">for</span>(Long64_t ev=0;ev&lt;<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;numEntries();ev++){<span class="comment">//loop over events</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//loop over species</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      eventW[iw]=<a class="code" href="classTHSsPlot.html#ac510207bfc684d2cfa58e68ce151c962">GetSWeight</a>(ev,<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.at(iw)-&gt;GetName());<span class="comment">//get weight for this species</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>){<span class="comment">//use ID from initial tree</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keyword">const</span> RooArgSet* vars=<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;get(ev);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#af68f8fcc1dd0af2054c8bd360c5cbf08">FillWeights</a>((Long64_t)vars-&gt;getRealValue(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>),eventW);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      } <span class="comment">//ID not defined just use entry number on tree</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#af68f8fcc1dd0af2054c8bd360c5cbf08">FillWeights</a>(ev,eventW);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#a323aef2e50fc4ec64816cab15a7dee7a">  206</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#a323aef2e50fc4ec64816cab15a7dee7a">THSsPlot::ExportWeights1</a>(TString wmname){</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot:ExportWeights1 no sPlot fit done as only 1 species left&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  Int_t NSpecies=<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.getSize();</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  TVectorD eventW(NSpecies); <span class="comment">//initialise weights vector</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//set name for each species, remove leading Yld_  </span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a32d4096c1a829e16345730d398703ea5">SetSpecies</a>(TString(<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.at(iw)-&gt;GetName()).Remove(0,4));</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">for</span>(Long64_t ev=0;ev&lt;<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;numEntries();ev++){<span class="comment">//loop over events</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//loop over species</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      eventW[iw]=1;<span class="comment">//get weight for this species</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>){<span class="comment">//use ID from initial tree</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keyword">const</span> RooArgSet* vars=<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;get(ev);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#af68f8fcc1dd0af2054c8bd360c5cbf08">FillWeights</a>((Long64_t)vars-&gt;getRealValue(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>),eventW);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    } <span class="comment">//ID not defined just use entry number on tree</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#af68f8fcc1dd0af2054c8bd360c5cbf08">FillWeights</a>(ev,eventW);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">///This function gives a weight=0 for each entry in the tree</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">///if event not in fit (outside limits),</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">///as such the weight tree could be used with TTree::AddFriend.</span></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#af411d4d671f1cb5ff0364d56ea7c5c3f">  227</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#af411d4d671f1cb5ff0364d56ea7c5c3f">THSsPlot::ExportTreeWeights</a>(TString wmname){</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::ExportTreeWeights &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetName()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetEntries()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>&lt;&lt;endl;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>) {cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::ExportTreeWeights( No tree found&quot;</span>&lt;&lt;endl;<span class="keywordflow">return</span>;}</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  Int_t NSpecies=<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.getSize();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  TVectorD eventW(NSpecies); <span class="comment">//initialise weights vector</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//set name for each species,remove &quot;Yld_&quot;</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a32d4096c1a829e16345730d398703ea5">SetSpecies</a>(TString(<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.at(iw)-&gt;GetName()).Remove(0,4));</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  Double_t tid=0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>)  <a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;SetBranchAddress(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>,&amp;tid);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  Long64_t Nds=0;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span>(Long64_t ev=0;ev&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetEntries();ev++){<span class="comment">//loop over events</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetEntry(ev);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>){<span class="comment">//use ID from initial tree</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keyword">const</span> RooArgSet* vars=<a class="code" href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">fData</a>-&gt;get(Nds);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      Long64_t <span class="keywordtype">id</span>=-1;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span>(vars) <span class="keywordtype">id</span>=(Long64_t)vars-&gt;getRealValue(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">if</span>(<span class="keywordtype">id</span>==(Long64_t)tid){<span class="comment">//event in dataset </span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//loop over species</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      eventW[iw]=<a class="code" href="classTHSsPlot.html#ac510207bfc684d2cfa58e68ce151c962">GetSWeight</a>(Nds,<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.at(iw)-&gt;GetName());<span class="comment">//get weight for this species</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    Nds++;<span class="comment">//go to next event in dataset</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      } </div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">else</span>{ <span class="comment">//not in dataset no weight calculated for this event set to zero</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//loop over species</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      eventW[iw]=0;<span class="comment">//set to zero</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">//don&#39;t increment Nds</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      } <span class="comment">//ID not defined just use entry number on tree</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#af68f8fcc1dd0af2054c8bd360c5cbf08">FillWeights</a>((Long64_t)tid,eventW); <span class="comment">//fill the weight for every tree event</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">else</span> {<span class="comment">//need to be same events in dataset as tree for this to be meaningful</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">for</span>(Int_t iw=0;iw&lt;NSpecies;iw++)<span class="comment">//loop over species</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        eventW[iw]=<a class="code" href="classTHSsPlot.html#ac510207bfc684d2cfa58e68ce151c962">GetSWeight</a>(ev,<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.at(iw)-&gt;GetName());<span class="comment">//get weight for      </span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#af68f8fcc1dd0af2054c8bd360c5cbf08">FillWeights</a>(ev,eventW);<span class="comment">//no tree id just fill with entry number</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#ad156cc70930e0190ddea3b966dc7747c">  263</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#ad156cc70930e0190ddea3b966dc7747c">THSsPlot::ExportWeightsToFile</a>(TString filename){</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  Info(<span class="stringliteral">&quot;THSsPlot::ExportWeightsToFile&quot;</span>,<span class="stringliteral">&quot; Exporting Weights to %s&quot;</span>,filename.Data());</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a7c1aa3be7243aac62a0dd552843fcf03">GetWeightList</a>())<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a65ed69272836ebd5b2c704784d146511">SortWeights</a>();<span class="comment">//if merged from differen  </span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a0a8f675162596f695898cf9fa6a4a6cd">Save</a>();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/////////////////////////////////////</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">///Constructs new map if not existing</span></div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#a93c942e2b73fb26fbe69f7c19703bc53">  271</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#a93c942e2b73fb26fbe69f7c19703bc53">THSsPlot::AddWeightMap</a>(<a class="code" href="classTHSWeights.html">THSWeights</a> *Wts){</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  Info(<span class="stringliteral">&quot;THSsPlot::AddWeightMap&quot;</span>,<span class="stringliteral">&quot; Start add weights %lld&quot;</span>,Wts-&gt;<a class="code" href="classTHSWeights.html#a3995635fb096f73049a371212178f1bd">Size</a>());</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>){<span class="comment">//construct new map if not existing</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;Construct new weightmap&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>=<span class="keyword">new</span> <a class="code" href="classTHSWeights.html">THSWeights</a>(<span class="stringliteral">&quot;WeightMap&quot;</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;SetTitle(GetName());</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a3c921186e360236cc0ae45f6299541f1">SetFile</a>(<a class="code" href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">fOutDir</a>+TString(<span class="stringliteral">&quot;Weights&quot;</span>)+GetName()+<span class="stringliteral">&quot;.root&quot;</span>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#ad056492dae67245d620ab7e60ff5396b">Add</a>(Wts);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">//////////////////////////////////////////////////////</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">///Look through sub fits and add the maps to the total</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">///loop over subfits.</span></div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#af89d8b91492b612bf11e20c2e5e10f44">  285</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#af89d8b91492b612bf11e20c2e5e10f44">THSsPlot::AddSubWeights</a>(){</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>){<span class="comment">//construct new map if not existing</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>=<span class="keyword">new</span> <a class="code" href="classTHSWeights.html">THSWeights</a>(<span class="stringliteral">&quot;WeightMap&quot;</span>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;SetTitle(GetName());</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">for</span>(Int_t i=0;i&lt;<a class="code" href="classTHSRooFit.html#a1055f0295dbd876bfaacbcae25531f37">fRooFits</a>-&gt;GetEntries();i++)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#ad056492dae67245d620ab7e60ff5396b">Add</a>(dynamic_cast&lt;THSsPlot*&gt;(<a class="code" href="classTHSRooFit.html#a1055f0295dbd876bfaacbcae25531f37">fRooFits</a>-&gt;At(i))-&gt;<a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>());</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#addc06625087d8851de364f33bcfdd6a4">  294</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#addc06625087d8851de364f33bcfdd6a4">THSsPlot::DrawTreeVar</a>(TString VarName,Int_t nbins,Double_t hmin,Double_t hmax){</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  Info(<span class="stringliteral">&quot;THSsPlot::DrawTreeVar&quot;</span>,<span class="stringliteral">&quot; %s&quot;</span>,VarName.Data());</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a56fd31ad551fc15333d17b757e956f5f">GetTree</a>())<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#afb7b3c40654fb77c9adec73b510556e2">LoadSaved</a>(<a class="code" href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">fOutDir</a>+TString(<span class="stringliteral">&quot;Weights&quot;</span>)+GetName()+<span class="stringliteral">&quot;.root&quot;</span>,<span class="stringliteral">&quot;HSsWeights&quot;</span>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  cout&lt;&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>&lt;&lt;endl;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetBranch(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>))<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>=kTRUE;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a56fd31ad551fc15333d17b757e956f5f">GetTree</a>()-&gt;GetEntries()!=<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetEntries()) {cout&lt;&lt;<span class="stringliteral">&quot;DrawTreeVar : Tree and Map have different entries!&quot;</span>&lt;&lt;<span class="stringliteral">&quot; &quot;</span> &lt;&lt;<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a56fd31ad551fc15333d17b757e956f5f">GetTree</a>()-&gt;GetEntries()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetEntries()&lt;&lt;endl;}</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a5446255e1d5bfa7bf7803a32c78cdbca">IsSorted</a>()) <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a65ed69272836ebd5b2c704784d146511">SortWeights</a>();</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  Double_t dVar=0;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;SetBranchStatus(VarName,1);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;SetBranchAddress(VarName,&amp;dVar)) {cout&lt;&lt;<span class="stringliteral">&quot;No variable in tree &quot;</span>&lt;&lt;VarName&lt;&lt;endl; <span class="keywordflow">return</span>;}</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  Double_t tid=0;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>)  <a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;SetBranchAddress(<a class="code" href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">fIDBranchName</a>,&amp;tid);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  vector&lt;TH1F* &gt; hists;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">//create histogram for each species</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  Int_t Nspecies=<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a20c77168092e7d71ca1e6e031703c711">GetNSpecies</a>();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">for</span>(Int_t isp=0;isp&lt;Nspecies;isp++){</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    TH1F* htemp=<span class="keyword">new</span> TH1F(<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a309c56ecec38cbf9ce7e2e72154007ba">GetSpeciesName</a>(isp)+VarName+GetName(),VarName+<span class="stringliteral">&quot; SWeighted &quot;</span>+<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a309c56ecec38cbf9ce7e2e72154007ba">GetSpeciesName</a>(isp),nbins,hmin,hmax);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    htemp-&gt;Sumw2();</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    hists.push_back(htemp);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classTHSRooFit.html#ac9365ec30ef403e06ca2296c3e268be4">fHists</a>-&gt;Add(hists[isp]); </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  Long64_t <span class="keywordtype">id</span>=0; <span class="comment">//can be diffent from event number, and can be filtered in dataset</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  Long64_t nds=0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">//loop over tree and fill with weight</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a27e63290a9634c628ffa55266752554f">SetCurrEntry</a>(0);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">for</span>(Long64_t ient=0;ient&lt;<a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetEntries();ient++){</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;GetEvent(ient);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="comment">//get the id for the event if not in tree</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">fGotID</a>) <span class="keywordtype">id</span>=ient;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">else</span> <span class="keywordtype">id</span>=(Long64_t)tid; </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a36264e25063150662dd556f8e47f153e">GetEntryBinarySearch</a>(<span class="keywordtype">id</span>)) <span class="keywordflow">continue</span>;<span class="comment">//look for this id in weights tree</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">for</span>(Int_t isp=0;isp&lt;Nspecies;isp++)<span class="comment">//Fill each species</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      hists[isp]-&gt;Fill(dVar,<a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a22642c0bed3a9e069365979c86ac3855">GetWeight</a>(isp));</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">//create canvas and draw</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  TCanvas *canvas=0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  TLegend* leg = <span class="keyword">new</span> TLegend(0.6, 0.7, 0.9, 0.9);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  leg-&gt;SetTextSize(0.03);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  leg-&gt;SetFillColor(0);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  </div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="classTHSRooFit.html#a930806846f61fb2b0a5e83b237415fbf">fCanvases</a>-&gt;Add(canvas=<span class="keyword">new</span> TCanvas(VarName+<span class="stringliteral">&quot;SW&quot;</span>,VarName+<span class="stringliteral">&quot;SW&quot;</span>));<span class="comment">//create new canvas for drawing on</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  hists[0]-&gt;Draw(); <span class="comment">//First time so need axis</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  leg-&gt;AddEntry(hists[0], hists[0]-&gt;GetTitle(), <span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  Double_t maxVal=hists[0]-&gt;GetMaximum();</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">for</span>(Int_t isp=1;isp&lt;Nspecies;isp++){</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    hists[isp]-&gt;SetLineColor(isp);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    leg-&gt;AddEntry(hists[isp], hists[isp]-&gt;GetTitle(), <span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    hists[isp]-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span>(maxVal&lt;hists[isp]-&gt;GetMaximum()) maxVal=hists[isp]-&gt;GetMaximum();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  hists[0]-&gt;SetMaximum(maxVal+0.05*maxVal);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  leg-&gt;Draw();</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">fTree</a>-&gt;ResetBranchAddresses();</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#aeca10de90070202d07af4435c83c4c84">  349</a></span>&#160;<a class="code" href="classTHSRooFit.html">THSRooFit</a>*  <a class="code" href="classTHSsPlot.html#aeca10de90070202d07af4435c83c4c84">THSsPlot::CreateSubFitBins</a>(TTree* ctree,TString rfname,Bool_t CopyTree){<span class="comment">//events already selected</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">//create a fit object for a subset of data either by setting cut</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">//or by fTree-&gt;SetEntryList prior to calling this function </span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">//It will be deleted by this object</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;THSsPlot::CreateSubFitBins with tree &quot;</span>&lt;&lt;ctree-&gt;GetName()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;CopyTree&lt;&lt;endl;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="classTHSsPlot.html">THSsPlot</a>* RFa=<span class="keyword">new</span> <a class="code" href="classTHSsPlot.html#ab9df10513125f593de27fab517f754b5">THSsPlot</a>(rfname);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#a7ed0ad5a2320f2065e49ee08c0ca67da">fBinnedFit</a>)RFa-&gt;<a class="code" href="classTHSRooFit.html#a3d20209c81fe1d9329817863d7f894a6">SetBinnedFit</a>();</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  RFa-&gt;<a class="code" href="classTHSsPlot.html#ad249515ba024c7ed92342a39309cf00d">SetSingleSpecies</a>(<a class="code" href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">fSingleSp</a>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  RFa-&gt;<a class="code" href="classTHSRooFit.html#a893b504968e607f53a1fe95b61de0086">SetBinDir</a>(<a class="code" href="classTHSRooFit.html#ac8d41dea1d15631d6c53e8897a3c7919">fBinDir</a>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  RFa-&gt;<a class="code" href="classTHSRooFit.html#aa229ce1bde67f12a5fd67a982bb1e875">SetOutDir</a>(<a class="code" href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">fOutDir</a>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#ada0157b88164901f7d75997f57139cbb">fInWeights</a>){</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    RFa-&gt;<a class="code" href="classTHSRooFit.html#aedce5610df8f19f7eb09897487aff562">SetInWeights</a>(<a class="code" href="classTHSRooFit.html#ada0157b88164901f7d75997f57139cbb">fInWeights</a>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    RFa-&gt;<a class="code" href="classTHSRooFit.html#a2bab22dccc46778a252f87c1a7ddc35f">SetWeightName</a>(<a class="code" href="classTHSRooFit.html#aa05e3fe24ec4c342a112c7bf868f04f8">fWeightName</a>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  RFa-&gt;<a class="code" href="classTHSRooFit.html#ac1cbb23e22f181211e9689af6e4175ef">SetNStudyTrials</a>(<a class="code" href="classTHSRooFit.html#a2473736cfda53d49f625d6ea4327ac34">fNStudyTrials</a>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  RFa-&gt;<a class="code" href="classTHSRooFit.html#aae0231077023a5d4be5b69ed20392f86">SetStudyPDF</a>(<a class="code" href="classTHSRooFit.html#a34181e909bf404882c01cebfdfe4b4d8">fStudyPDF</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  RFa-&gt;<a class="code" href="classTHSsPlot.html#a403aefa2b42cc0723920b8f17432bca8">SetSPlotRange</a>(<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[0],<a class="code" href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">fSRange</a>[1]);<span class="comment">//Extra to THSRooFit</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="comment">//Done configuring RF</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <a class="code" href="classTHSRooFit.html#a1055f0295dbd876bfaacbcae25531f37">fRooFits</a>-&gt;Add(RFa);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  RFa-&gt;<a class="code" href="classTHSRooFit.html#a7f5508a7cab0082a6df2ffcad8d1ede7">LoadWorkSpace</a>(<a class="code" href="classTHSRooFit.html#acd8ca461329653b06b52953f1772197a">fWS</a>,GetName());</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  RFa-&gt;<a class="code" href="classTHSRooFit.html#a3147ca6fa1211aa649af205b7d7bc2f8">GetVariables</a>().Print();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">//  RFa-&gt;SetIDBranchName(fIDBranchName);</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">for</span>(Int_t ill=0;ill&lt;<a class="code" href="classTHSRooFit.html#aeafc36ec5e9ccbcea880de858d618879">fFitOptions</a>.GetSize();ill++)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    RFa-&gt;<a class="code" href="classTHSRooFit.html#a72856411a5334cd5f9b679b482140594">AddFitOption</a>(*((RooCmdArg*)<a class="code" href="classTHSRooFit.html#aeafc36ec5e9ccbcea880de858d618879">fFitOptions</a>.At(ill)));</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  TDirectory *saveDir=gDirectory;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  ctree-&gt;GetDirectory()-&gt;cd();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">if</span>(CopyTree)RFa-&gt;<a class="code" href="classTHSRooFit.html#ac55d5ec13169c50f805cac5e8e11628f">LoadDataSet</a>(ctree-&gt;CopyTree(<span class="stringliteral">&quot;&quot;</span>));<span class="comment">//will use any EntryList</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">else</span> RFa-&gt;<a class="code" href="classTHSRooFit.html#ac55d5ec13169c50f805cac5e8e11628f">LoadDataSet</a>(ctree);<span class="comment">//use whole tree</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  saveDir-&gt;cd();</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  RFa-&gt;<a class="code" href="classTHSRooFit.html#a579eb4e03f1f6426d9a4342ab49b1dd0">SetDataWeight</a>();<span class="comment">//if defined weights use them for this dataset</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">return</span> RFa;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#af7d4aaa595a678ce0d184ec4212fd409">  385</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#af7d4aaa595a678ce0d184ec4212fd409">THSsPlot::SaveHists</a>(TString filename){</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  TFile* file=<span class="keyword">new</span> TFile(filename,<span class="stringliteral">&quot;recreate&quot;</span>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="classTHSRooFit.html#ac9365ec30ef403e06ca2296c3e268be4">fHists</a>-&gt;Write();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  file-&gt;Close();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keyword">delete</span> file;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">///////////////////////////////////////////////////</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">/// Call this function to generate Nfits fits.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">/// Fit the model to data with only species yields as free pars,</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">/// calculate weights and import to WeightMap.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">/// Remove any zero yield to be constant to help fit converge</span></div><div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#adc9315e2ee57303ee91b55e1d517ef91">  397</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#adc9315e2ee57303ee91b55e1d517ef91">THSsPlot::FitAndStudy</a>(Int_t Nfits){</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">//Create new fit and load the new bin data tree</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSRooFit.html#acd8ca461329653b06b52953f1772197a">fWS</a>-&gt;set(TString(GetName())+<span class="stringliteral">&quot;PDFs&quot;</span>))<a class="code" href="classTHSRooFit.html#a11535448e308b2d9c3795e459731cd19">DefineSets</a>();</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classTHSRooFit.html#a26564e683834f3c10a3259f9613a29b6">fModel</a>) <a class="code" href="classTHSRooFit.html#a1e03e43cf4d35342b6d05dab87e2dc03">TotalPDF</a>();</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="classTHSRooFit.html#a3624a6fc31a93e3f0e787771b7ea141c">FitMany</a>(Nfits);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">for</span>(Int_t iy=0;iy&lt;<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.getSize();iy++){</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    Double_t  thisYield=((RooRealVar*)&amp;<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>[iy])-&gt;getVal();</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span>(thisYield&lt;1E-2){</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="comment">//Need to remove this pdf all weights weights will not be written for this species</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      RooRealVar* yield0=(RooRealVar*)&amp;<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>[iy];</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="classTHSRooFit.html#a2fa8f2414c4d819d8a2135ace2c19604">GetPDFsp</a>()-&gt;remove(<a class="code" href="classTHSRooFit.html#a43396b8f4d30752690015e14315bfc5b">GetPDFs</a>()[iy]);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <a class="code" href="classTHSRooFit.html#a6ae06d6b1c73d7f4a8dbae87f7131630">GetYieldsp</a>()-&gt;remove(*(<a class="code" href="classTHSsPlot.html#a3fe17453feac7b7afa8b9536febf68ed">GetWorkSpace</a>()-&gt;var(yield0-&gt;GetName())));</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="classTHSsPlot.html#a3fe17453feac7b7afa8b9536febf68ed">GetWorkSpace</a>()-&gt;removeSet(<span class="stringliteral">&quot;Yields&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <a class="code" href="classTHSsPlot.html#a3fe17453feac7b7afa8b9536febf68ed">GetWorkSpace</a>()-&gt;removeSet(<span class="stringliteral">&quot;PDFs&quot;</span>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="classTHSsPlot.html#a3fe17453feac7b7afa8b9536febf68ed">GetWorkSpace</a>()-&gt;defineSet(<span class="stringliteral">&quot;Yields&quot;</span>,<a class="code" href="classTHSRooFit.html#a58928f6ade0347e7299a61bc6050ef7f">GetYields</a>());</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="classTHSsPlot.html#a3fe17453feac7b7afa8b9536febf68ed">GetWorkSpace</a>()-&gt;defineSet(<span class="stringliteral">&quot;PDFs&quot;</span>,<a class="code" href="classTHSRooFit.html#a43396b8f4d30752690015e14315bfc5b">GetPDFs</a>());  </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">fYields</a>.getSize()==1){<span class="comment">//Only 1 species all weights==1</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>=<span class="keyword">new</span> <a class="code" href="classTHSWeights.html">THSWeights</a>(<span class="stringliteral">&quot;HSsWeights&quot;</span>);<span class="comment">//initialise weights</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;SetTitle(GetName());</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">fWeights</a>-&gt;<a class="code" href="classTHSWeights.html#a3c921186e360236cc0ae45f6299541f1">SetFile</a>(<a class="code" href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">fOutDir</a>+TString(<span class="stringliteral">&quot;Weights&quot;</span>)+GetName()+<span class="stringliteral">&quot;.root&quot;</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="classTHSsPlot.html#a323aef2e50fc4ec64816cab15a7dee7a">ExportWeights1</a>();</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>()-&gt;<a class="code" href="classTHSWeights.html#a09aac4724174504cf0cb5b926f07690c">PrintWeight</a>();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>()-&gt;<a class="code" href="classTHSWeights.html#a65ed69272836ebd5b2c704784d146511">SortWeights</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#a3177e54ac4870317595d4b29e84afff7">fSaveWeights</a>) <a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>()-&gt;<a class="code" href="classTHSWeights.html#a0a8f675162596f695898cf9fa6a4a6cd">Save</a>();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="classTHSsPlot.html#aa1b883fbf2b829f9de071511f79b1c75">sPlot</a>();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">//save any canvases produced</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  Info(<span class="stringliteral">&quot;THSsPlot::FitAndStudy&quot;</span>,<span class="stringliteral">&quot;Save to %s&quot;</span>,(<a class="code" href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">fOutDir</a>+TString(<span class="stringliteral">&quot;Results&quot;</span>)+GetName()).Data());</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="classTHSRooFit.html#aeee56be81e7a378961314f5d883a7d10">SavePlots</a>(<a class="code" href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">fOutDir</a>+TString(<span class="stringliteral">&quot;Results&quot;</span>)+GetName()+<span class="stringliteral">&quot;.root&quot;</span>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="classTHSRooFit.html#a8f1180233ff76202db476f837f1db1d5">StudyFit</a>();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">//save weights to file</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>()){</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>()-&gt;<a class="code" href="classTHSWeights.html#a09aac4724174504cf0cb5b926f07690c">PrintWeight</a>();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>()-&gt;<a class="code" href="classTHSWeights.html#a65ed69272836ebd5b2c704784d146511">SortWeights</a>();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classTHSsPlot.html#a3177e54ac4870317595d4b29e84afff7">fSaveWeights</a>) <a class="code" href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">GetWeights</a>()-&gt;<a class="code" href="classTHSWeights.html#a0a8f675162596f695898cf9fa6a4a6cd">Save</a>();<span class="comment">//don&#39;t save if single bin so we can draw</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="classTHSsPlot.html#a397963a3aa84fcb7bca749c6ae063ba8">  441</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSsPlot.html#a397963a3aa84fcb7bca749c6ae063ba8">THSsPlot::DefaultFitOptions</a>(){</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// AddFitOption(RooFit::Extended());</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">// if(fData)</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">//   if(fData-&gt;isNonPoissonWeighted())AddFitOption(RooFit::SumW2Error(kTRUE));</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="classTHSRooFit.html#a72856411a5334cd5f9b679b482140594">AddFitOption</a>(RooFit::NumCPU(1));</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classTHSRooFit.html#a72856411a5334cd5f9b679b482140594">AddFitOption</a>(RooFit::Save(kTRUE));</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="classTHSRooFit.html#a72856411a5334cd5f9b679b482140594">AddFitOption</a>(RooFit::Warnings(kFALSE));</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="classTHSRooFit_html"><div class="ttname"><a href="classTHSRooFit.html">THSRooFit</a></div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00031">THSRooFit.h:31</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ac1f6c72608abd297f1669b802bcf315c"><div class="ttname"><a href="classTHSRooFit.html#ac1f6c72608abd297f1669b802bcf315c">THSRooFit::PlotDataModel</a></div><div class="ttdeci">void PlotDataModel()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00467">THSRooFit.C:467</a></div></div>
<div class="ttc" id="classTHSWeights_html_a7c1aa3be7243aac62a0dd552843fcf03"><div class="ttname"><a href="classTHSWeights.html#a7c1aa3be7243aac62a0dd552843fcf03">THSWeights::GetWeightList</a></div><div class="ttdeci">TList * GetWeightList()</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00068">THSWeights.h:68</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a323aef2e50fc4ec64816cab15a7dee7a"><div class="ttname"><a href="classTHSsPlot.html#a323aef2e50fc4ec64816cab15a7dee7a">THSsPlot::ExportWeights1</a></div><div class="ttdeci">void ExportWeights1(TString wmname=&quot;WeightMap&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00206">THSsPlot.C:206</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ac1cbb23e22f181211e9689af6e4175ef"><div class="ttname"><a href="classTHSRooFit.html#ac1cbb23e22f181211e9689af6e4175ef">THSRooFit::SetNStudyTrials</a></div><div class="ttdeci">void SetNStudyTrials(Int_t Nt)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00175">THSRooFit.h:175</a></div></div>
<div class="ttc" id="classTHSRooFit_html_acd8ca461329653b06b52953f1772197a"><div class="ttname"><a href="classTHSRooFit.html#acd8ca461329653b06b52953f1772197a">THSRooFit::fWS</a></div><div class="ttdeci">RooWorkspace * fWS</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00033">THSRooFit.h:33</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a3500524bd77af7c21a6f349fa412ae9d"><div class="ttname"><a href="classTHSRooFit.html#a3500524bd77af7c21a6f349fa412ae9d">THSRooFit::fData</a></div><div class="ttdeci">RooAbsData * fData</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00043">THSRooFit.h:43</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a43396b8f4d30752690015e14315bfc5b"><div class="ttname"><a href="classTHSRooFit.html#a43396b8f4d30752690015e14315bfc5b">THSRooFit::GetPDFs</a></div><div class="ttdeci">RooArgList GetPDFs()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00108">THSRooFit.h:108</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a3fe17453feac7b7afa8b9536febf68ed"><div class="ttname"><a href="classTHSsPlot.html#a3fe17453feac7b7afa8b9536febf68ed">THSsPlot::GetWorkSpace</a></div><div class="ttdeci">RooWorkspace * GetWorkSpace()</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00023">THSsPlot.h:23</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a78ad585293af9dd818f57a073e1b2742"><div class="ttname"><a href="classTHSRooFit.html#a78ad585293af9dd818f57a073e1b2742">THSRooFit::fIsPlot</a></div><div class="ttdeci">Bool_t fIsPlot</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00061">THSRooFit.h:61</a></div></div>
<div class="ttc" id="classTHSsPlot_html_ac510207bfc684d2cfa58e68ce151c962"><div class="ttname"><a href="classTHSsPlot.html#ac510207bfc684d2cfa58e68ce151c962">THSsPlot::GetSWeight</a></div><div class="ttdeci">Double_t GetSWeight(Long64_t event, TString species)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00183">THSsPlot.C:183</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a3147ca6fa1211aa649af205b7d7bc2f8"><div class="ttname"><a href="classTHSRooFit.html#a3147ca6fa1211aa649af205b7d7bc2f8">THSRooFit::GetVariables</a></div><div class="ttdeci">RooArgList GetVariables()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00097">THSRooFit.h:97</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a3177e54ac4870317595d4b29e84afff7"><div class="ttname"><a href="classTHSsPlot.html#a3177e54ac4870317595d4b29e84afff7">THSsPlot::fSaveWeights</a></div><div class="ttdeci">Bool_t fSaveWeights</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00013">THSsPlot.h:13</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a12ae89285f80d73e3bff853223b843c4"><div class="ttname"><a href="classTHSsPlot.html#a12ae89285f80d73e3bff853223b843c4">THSsPlot::fWeights</a></div><div class="ttdeci">THSWeights * fWeights</div><div class="ttdoc">//sPlot object </div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00011">THSsPlot.h:11</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a00661c2bf3c56fa9d949716d00d66aa6"><div class="ttname"><a href="classTHSRooFit.html#a00661c2bf3c56fa9d949716d00d66aa6">THSRooFit::fIDBranchName</a></div><div class="ttdeci">TString fIDBranchName</div><div class="ttdoc">//tree for calculating MC based NormInt </div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00050">THSRooFit.h:50</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a7f5508a7cab0082a6df2ffcad8d1ede7"><div class="ttname"><a href="classTHSRooFit.html#a7f5508a7cab0082a6df2ffcad8d1ede7">THSRooFit::LoadWorkSpace</a></div><div class="ttdeci">void LoadWorkSpace(RooWorkspace *ws, TString rfname=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00154">THSRooFit.C:154</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a9d45c871453c0cb7ed2c428caf18d6f9"><div class="ttname"><a href="classTHSsPlot.html#a9d45c871453c0cb7ed2c428caf18d6f9">THSsPlot::~THSsPlot</a></div><div class="ttdeci">virtual ~THSsPlot()</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00038">THSsPlot.C:38</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a26564e683834f3c10a3259f9613a29b6"><div class="ttname"><a href="classTHSRooFit.html#a26564e683834f3c10a3259f9613a29b6">THSRooFit::fModel</a></div><div class="ttdeci">RooAbsPdf * fModel</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00042">THSRooFit.h:42</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a43f38df9812e1fc171f1a35cc5510689"><div class="ttname"><a href="classTHSsPlot.html#a43f38df9812e1fc171f1a35cc5510689">THSsPlot::ExportWeights</a></div><div class="ttdeci">void ExportWeights(TString wmname=&quot;WeightMap&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00188">THSsPlot.C:188</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aeee56be81e7a378961314f5d883a7d10"><div class="ttname"><a href="classTHSRooFit.html#aeee56be81e7a378961314f5d883a7d10">THSRooFit::SavePlots</a></div><div class="ttdeci">void SavePlots(TString filename)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00605">THSRooFit.C:605</a></div></div>
<div class="ttc" id="THSsPlot_8C_html_a870c8db1b5cf027fa6502f9b8be7b262"><div class="ttname"><a href="THSsPlot_8C.html#a870c8db1b5cf027fa6502f9b8be7b262">ClassImp</a></div><div class="ttdeci">ClassImp(THSsPlot)</div></div>
<div class="ttc" id="classTHSRooFit_html_a58928f6ade0347e7299a61bc6050ef7f"><div class="ttname"><a href="classTHSRooFit.html#a58928f6ade0347e7299a61bc6050ef7f">THSRooFit::GetYields</a></div><div class="ttdeci">RooArgList GetYields()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00105">THSRooFit.h:105</a></div></div>
<div class="ttc" id="classTHSRooFit_html_af96f0fb5be59b14b1a19ef31d3a859b2"><div class="ttname"><a href="classTHSRooFit.html#af96f0fb5be59b14b1a19ef31d3a859b2">THSRooFit::fYields</a></div><div class="ttdeci">RooArgList fYields</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00037">THSRooFit.h:37</a></div></div>
<div class="ttc" id="classTHSsPlot_html_ab9df10513125f593de27fab517f754b5"><div class="ttname"><a href="classTHSsPlot.html#ab9df10513125f593de27fab517f754b5">THSsPlot::THSsPlot</a></div><div class="ttdeci">THSsPlot()</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00020">THSsPlot.C:20</a></div></div>
<div class="ttc" id="classTHSWeights_html_a309c56ecec38cbf9ce7e2e72154007ba"><div class="ttname"><a href="classTHSWeights.html#a309c56ecec38cbf9ce7e2e72154007ba">THSWeights::GetSpeciesName</a></div><div class="ttdeci">TString GetSpeciesName(UInt_t isp)</div><div class="ttdoc">Find the name for a given index. </div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00148">THSWeights.C:148</a></div></div>
<div class="ttc" id="classTHSWeights_html_a20c77168092e7d71ca1e6e031703c711"><div class="ttname"><a href="classTHSWeights.html#a20c77168092e7d71ca1e6e031703c711">THSWeights::GetNSpecies</a></div><div class="ttdeci">Int_t GetNSpecies()</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00062">THSWeights.h:62</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aa05e3fe24ec4c342a112c7bf868f04f8"><div class="ttname"><a href="classTHSRooFit.html#aa05e3fe24ec4c342a112c7bf868f04f8">THSRooFit::fWeightName</a></div><div class="ttdeci">TString fWeightName</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00055">THSRooFit.h:55</a></div></div>
<div class="ttc" id="classTHSsPlot_html_af411d4d671f1cb5ff0364d56ea7c5c3f"><div class="ttname"><a href="classTHSsPlot.html#af411d4d671f1cb5ff0364d56ea7c5c3f">THSsPlot::ExportTreeWeights</a></div><div class="ttdeci">void ExportTreeWeights(TString wmname=&quot;WeightMap&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00227">THSsPlot.C:227</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a14d7cf1b72fdd8b017633f039abd4983"><div class="ttname"><a href="classTHSRooFit.html#a14d7cf1b72fdd8b017633f039abd4983">THSRooFit::fChi2</a></div><div class="ttdeci">Double_t fChi2</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00066">THSRooFit.h:66</a></div></div>
<div class="ttc" id="classTHSsPlot_html_aa1b883fbf2b829f9de071511f79b1c75"><div class="ttname"><a href="classTHSsPlot.html#aa1b883fbf2b829f9de071511f79b1c75">THSsPlot::sPlot</a></div><div class="ttdeci">void sPlot()</div><div class="ttdoc">Perform fit of yields to get sWeights. </div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00121">THSsPlot.C:121</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aa229ce1bde67f12a5fd67a982bb1e875"><div class="ttname"><a href="classTHSRooFit.html#aa229ce1bde67f12a5fd67a982bb1e875">THSRooFit::SetOutDir</a></div><div class="ttdeci">void SetOutDir(TString name)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00160">THSRooFit.h:160</a></div></div>
<div class="ttc" id="classTHSWeights_html"><div class="ttname"><a href="classTHSWeights.html">THSWeights</a></div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00014">THSWeights.h:14</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a1e03e43cf4d35342b6d05dab87e2dc03"><div class="ttname"><a href="classTHSRooFit.html#a1e03e43cf4d35342b6d05dab87e2dc03">THSRooFit::TotalPDF</a></div><div class="ttdeci">void TotalPDF()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00345">THSRooFit.C:345</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a7ed0ad5a2320f2065e49ee08c0ca67da"><div class="ttname"><a href="classTHSRooFit.html#a7ed0ad5a2320f2065e49ee08c0ca67da">THSRooFit::fBinnedFit</a></div><div class="ttdeci">Bool_t fBinnedFit</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00062">THSRooFit.h:62</a></div></div>
<div class="ttc" id="classTHSWeights_html_a09aac4724174504cf0cb5b926f07690c"><div class="ttname"><a href="classTHSWeights.html#a09aac4724174504cf0cb5b926f07690c">THSWeights::PrintWeight</a></div><div class="ttdeci">void PrintWeight()</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00197">THSWeights.C:197</a></div></div>
<div class="ttc" id="classTHSWeights_html_a3995635fb096f73049a371212178f1bd"><div class="ttname"><a href="classTHSWeights.html#a3995635fb096f73049a371212178f1bd">THSWeights::Size</a></div><div class="ttdeci">Long64_t Size()</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00058">THSWeights.h:58</a></div></div>
<div class="ttc" id="classTHSWeights_html_a22642c0bed3a9e069365979c86ac3855"><div class="ttname"><a href="classTHSWeights.html#a22642c0bed3a9e069365979c86ac3855">THSWeights::GetWeight</a></div><div class="ttdeci">Double_t GetWeight(TString spe)</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00046">THSWeights.h:46</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a893b504968e607f53a1fe95b61de0086"><div class="ttname"><a href="classTHSRooFit.html#a893b504968e607f53a1fe95b61de0086">THSRooFit::SetBinDir</a></div><div class="ttdeci">void SetBinDir(TString name)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00161">THSRooFit.h:161</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a3d20209c81fe1d9329817863d7f894a6"><div class="ttname"><a href="classTHSRooFit.html#a3d20209c81fe1d9329817863d7f894a6">THSRooFit::SetBinnedFit</a></div><div class="ttdeci">void SetBinnedFit(Bool_t bf=kTRUE)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00166">THSRooFit.h:166</a></div></div>
<div class="ttc" id="classTHSsPlot_html_ad156cc70930e0190ddea3b966dc7747c"><div class="ttname"><a href="classTHSsPlot.html#ad156cc70930e0190ddea3b966dc7747c">THSsPlot::ExportWeightsToFile</a></div><div class="ttdeci">void ExportWeightsToFile(TString filename)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00263">THSsPlot.C:263</a></div></div>
<div class="ttc" id="classTHSWeights_html_a3c921186e360236cc0ae45f6299541f1"><div class="ttname"><a href="classTHSWeights.html#a3c921186e360236cc0ae45f6299541f1">THSWeights::SetFile</a></div><div class="ttdeci">void SetFile(TString filename)</div><div class="ttdoc">Set file for keeping weights on disk. </div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00278">THSWeights.C:278</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a930806846f61fb2b0a5e83b237415fbf"><div class="ttname"><a href="classTHSRooFit.html#a930806846f61fb2b0a5e83b237415fbf">THSRooFit::fCanvases</a></div><div class="ttdeci">TList * fCanvases</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00044">THSRooFit.h:44</a></div></div>
<div class="ttc" id="classTHSWeights_html_ad056492dae67245d620ab7e60ff5396b"><div class="ttname"><a href="classTHSWeights.html#ad056492dae67245d620ab7e60ff5396b">THSWeights::Add</a></div><div class="ttdeci">void Add(THSWeights *wm)</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00161">THSWeights.C:161</a></div></div>
<div class="ttc" id="classTHSWeights_html_a0a8f675162596f695898cf9fa6a4a6cd"><div class="ttname"><a href="classTHSWeights.html#a0a8f675162596f695898cf9fa6a4a6cd">THSWeights::Save</a></div><div class="ttdeci">void Save()</div><div class="ttdoc">Finally save weights to disk. </div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00288">THSWeights.C:288</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ac7feeaeb6c45b0c93764bcf43713702e"><div class="ttname"><a href="classTHSRooFit.html#ac7feeaeb6c45b0c93764bcf43713702e">THSRooFit::fTree</a></div><div class="ttdeci">TTree * fTree</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00047">THSRooFit.h:47</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a397963a3aa84fcb7bca749c6ae063ba8"><div class="ttname"><a href="classTHSsPlot.html#a397963a3aa84fcb7bca749c6ae063ba8">THSsPlot::DefaultFitOptions</a></div><div class="ttdeci">virtual void DefaultFitOptions()</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00441">THSsPlot.C:441</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ac55d5ec13169c50f805cac5e8e11628f"><div class="ttname"><a href="classTHSRooFit.html#ac55d5ec13169c50f805cac5e8e11628f">THSRooFit::LoadDataSet</a></div><div class="ttdeci">void LoadDataSet(TTree *tree, Bool_t toWS=kFALSE)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00111">THSRooFit.C:111</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aae0231077023a5d4be5b69ed20392f86"><div class="ttname"><a href="classTHSRooFit.html#aae0231077023a5d4be5b69ed20392f86">THSRooFit::SetStudyPDF</a></div><div class="ttdeci">void SetStudyPDF(TString pdfn)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00176">THSRooFit.h:176</a></div></div>
<div class="ttc" id="classTHSWeights_html_a36264e25063150662dd556f8e47f153e"><div class="ttname"><a href="classTHSWeights.html#a36264e25063150662dd556f8e47f153e">THSWeights::GetEntryBinarySearch</a></div><div class="ttdeci">Bool_t GetEntryBinarySearch(Long64_t id)</div><div class="ttdoc">Use a binary search to find the entry for an unsorted tree. </div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00088">THSWeights.C:88</a></div></div>
<div class="ttc" id="classTHSWeights_html_af68f8fcc1dd0af2054c8bd360c5cbf08"><div class="ttname"><a href="classTHSWeights.html#af68f8fcc1dd0af2054c8bd360c5cbf08">THSWeights::FillWeights</a></div><div class="ttdeci">void FillWeights(Long64_t ev, TVectorD wgt)</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00039">THSWeights.h:39</a></div></div>
<div class="ttc" id="classTHSsPlot_html_adc9315e2ee57303ee91b55e1d517ef91"><div class="ttname"><a href="classTHSsPlot.html#adc9315e2ee57303ee91b55e1d517ef91">THSsPlot::FitAndStudy</a></div><div class="ttdeci">virtual void FitAndStudy(Int_t Nfits)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00397">THSsPlot.C:397</a></div></div>
<div class="ttc" id="classTHSsPlot_html_ad249515ba024c7ed92342a39309cf00d"><div class="ttname"><a href="classTHSsPlot.html#ad249515ba024c7ed92342a39309cf00d">THSsPlot::SetSingleSpecies</a></div><div class="ttdeci">void SetSingleSpecies(TString ssp)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00029">THSsPlot.h:29</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ac8d41dea1d15631d6c53e8897a3c7919"><div class="ttname"><a href="classTHSRooFit.html#ac8d41dea1d15631d6c53e8897a3c7919">THSRooFit::fBinDir</a></div><div class="ttdeci">TString fBinDir</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00054">THSRooFit.h:54</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a93c942e2b73fb26fbe69f7c19703bc53"><div class="ttname"><a href="classTHSsPlot.html#a93c942e2b73fb26fbe69f7c19703bc53">THSsPlot::AddWeightMap</a></div><div class="ttdeci">void AddWeightMap(THSWeights *Wts)</div><div class="ttdoc">Constructs new map if not existing. </div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00271">THSsPlot.C:271</a></div></div>
<div class="ttc" id="classTHSWeights_html_a32d4096c1a829e16345730d398703ea5"><div class="ttname"><a href="classTHSWeights.html#a32d4096c1a829e16345730d398703ea5">THSWeights::SetSpecies</a></div><div class="ttdeci">void SetSpecies(TString name)</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00040">THSWeights.C:40</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a34181e909bf404882c01cebfdfe4b4d8"><div class="ttname"><a href="classTHSRooFit.html#a34181e909bf404882c01cebfdfe4b4d8">THSRooFit::fStudyPDF</a></div><div class="ttdeci">TString fStudyPDF</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00056">THSRooFit.h:56</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a8f1180233ff76202db476f837f1db1d5"><div class="ttname"><a href="classTHSRooFit.html#a8f1180233ff76202db476f837f1db1d5">THSRooFit::StudyFit</a></div><div class="ttdeci">void StudyFit()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00797">THSRooFit.C:797</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a3624a6fc31a93e3f0e787771b7ea141c"><div class="ttname"><a href="classTHSRooFit.html#a3624a6fc31a93e3f0e787771b7ea141c">THSRooFit::FitMany</a></div><div class="ttdeci">virtual void FitMany(Int_t Nfits=1)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00814">THSRooFit.C:814</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a2afc78baf86765b63ac69b77c59b22eb"><div class="ttname"><a href="classTHSRooFit.html#a2afc78baf86765b63ac69b77c59b22eb">THSRooFit::fFiti</a></div><div class="ttdeci">Int_t fFiti</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00067">THSRooFit.h:67</a></div></div>
<div class="ttc" id="classTHSsPlot_html_adffb1c40ecdd267cdbcee64587f5a4cf"><div class="ttname"><a href="classTHSsPlot.html#adffb1c40ecdd267cdbcee64587f5a4cf">THSsPlot::fSPlot</a></div><div class="ttdeci">RooStats::SPlot * fSPlot</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00010">THSsPlot.h:10</a></div></div>
<div class="ttc" id="classTHSsPlot_html_ae214cc0a98022e2d0400168a28c1b5b0"><div class="ttname"><a href="classTHSsPlot.html#ae214cc0a98022e2d0400168a28c1b5b0">THSsPlot::MergeModelSpecies</a></div><div class="ttdeci">void MergeModelSpecies()</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00048">THSsPlot.C:48</a></div></div>
<div class="ttc" id="classTHSsPlot_html_af89d8b91492b612bf11e20c2e5e10f44"><div class="ttname"><a href="classTHSsPlot.html#af89d8b91492b612bf11e20c2e5e10f44">THSsPlot::AddSubWeights</a></div><div class="ttdeci">void AddSubWeights()</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00285">THSsPlot.C:285</a></div></div>
<div class="ttc" id="classTHSWeights_html_a56fd31ad551fc15333d17b757e956f5f"><div class="ttname"><a href="classTHSWeights.html#a56fd31ad551fc15333d17b757e956f5f">THSWeights::GetTree</a></div><div class="ttdeci">TTree * GetTree()</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00037">THSWeights.h:37</a></div></div>
<div class="ttc" id="classTHSsPlot_html"><div class="ttname"><a href="classTHSsPlot.html">THSsPlot</a></div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00008">THSsPlot.h:8</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a10726f4f43d8e6b4dac077c3901f5fe6"><div class="ttname"><a href="classTHSRooFit.html#a10726f4f43d8e6b4dac077c3901f5fe6">THSRooFit::fPDFs</a></div><div class="ttdeci">RooArgList fPDFs</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00038">THSRooFit.h:38</a></div></div>
<div class="ttc" id="classTHSWeights_html_a65ed69272836ebd5b2c704784d146511"><div class="ttname"><a href="classTHSWeights.html#a65ed69272836ebd5b2c704784d146511">THSWeights::SortWeights</a></div><div class="ttdeci">void SortWeights()</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00236">THSWeights.C:236</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a74fee3ec372e3f44fc8c66a6ced097d0"><div class="ttname"><a href="classTHSsPlot.html#a74fee3ec372e3f44fc8c66a6ced097d0">THSsPlot::fSRange</a></div><div class="ttdeci">Double_t fSRange[2]</div><div class="ttdoc">new weights calcualted in this fit </div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00012">THSsPlot.h:12</a></div></div>
<div class="ttc" id="classTHSsPlot_html_af7d4aaa595a678ce0d184ec4212fd409"><div class="ttname"><a href="classTHSsPlot.html#af7d4aaa595a678ce0d184ec4212fd409">THSsPlot::SaveHists</a></div><div class="ttdeci">void SaveHists(TString filename)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00385">THSsPlot.C:385</a></div></div>
<div class="ttc" id="classTHSsPlot_html_aeca10de90070202d07af4435c83c4c84"><div class="ttname"><a href="classTHSsPlot.html#aeca10de90070202d07af4435c83c4c84">THSsPlot::CreateSubFitBins</a></div><div class="ttdeci">virtual THSRooFit * CreateSubFitBins(TTree *ctree, TString rfname, Bool_t CopyTree)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00349">THSsPlot.C:349</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a11535448e308b2d9c3795e459731cd19"><div class="ttname"><a href="classTHSRooFit.html#a11535448e308b2d9c3795e459731cd19">THSRooFit::DefineSets</a></div><div class="ttdeci">void DefineSets()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00189">THSRooFit.C:189</a></div></div>
<div class="ttc" id="classTHSsPlot_html_addc06625087d8851de364f33bcfdd6a4"><div class="ttname"><a href="classTHSsPlot.html#addc06625087d8851de364f33bcfdd6a4">THSsPlot::DrawTreeVar</a></div><div class="ttdeci">void DrawTreeVar(TString VarName, Int_t nbins, Double_t hmin, Double_t hmax)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8C_source.html#l00294">THSsPlot.C:294</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aec780a4b9305b9af2f3ecfa284fbf2a6"><div class="ttname"><a href="classTHSRooFit.html#aec780a4b9305b9af2f3ecfa284fbf2a6">THSRooFit::fID</a></div><div class="ttdeci">RooRealVar * fID</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00041">THSRooFit.h:41</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a92625a1c9d2b6dc2c1f68e9efffbdefc"><div class="ttname"><a href="classTHSRooFit.html#a92625a1c9d2b6dc2c1f68e9efffbdefc">THSRooFit::fYld</a></div><div class="ttdeci">TString fYld</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00051">THSRooFit.h:51</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a2bab22dccc46778a252f87c1a7ddc35f"><div class="ttname"><a href="classTHSRooFit.html#a2bab22dccc46778a252f87c1a7ddc35f">THSRooFit::SetWeightName</a></div><div class="ttdeci">void SetWeightName(TString WName)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00279">THSRooFit.C:279</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a78f90f84a16da80b861be65e306f3a95"><div class="ttname"><a href="classTHSRooFit.html#a78f90f84a16da80b861be65e306f3a95">THSRooFit::THSRooFit</a></div><div class="ttdeci">THSRooFit()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00025">THSRooFit.C:25</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a036c0eda5ee1d6f1468b919940e575b1"><div class="ttname"><a href="classTHSRooFit.html#a036c0eda5ee1d6f1468b919940e575b1">THSRooFit::fSingleSp</a></div><div class="ttdeci">TString fSingleSp</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00052">THSRooFit.h:52</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a1055f0295dbd876bfaacbcae25531f37"><div class="ttname"><a href="classTHSRooFit.html#a1055f0295dbd876bfaacbcae25531f37">THSRooFit::fRooFits</a></div><div class="ttdeci">TList * fRooFits</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00046">THSRooFit.h:46</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a6ae06d6b1c73d7f4a8dbae87f7131630"><div class="ttname"><a href="classTHSRooFit.html#a6ae06d6b1c73d7f4a8dbae87f7131630">THSRooFit::GetYieldsp</a></div><div class="ttdeci">RooArgList * GetYieldsp()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00107">THSRooFit.h:107</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ad1ca0f44be73ab17905cb8c02cc303e6"><div class="ttname"><a href="classTHSRooFit.html#ad1ca0f44be73ab17905cb8c02cc303e6">THSRooFit::fOutDir</a></div><div class="ttdeci">TString fOutDir</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00053">THSRooFit.h:53</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a579eb4e03f1f6426d9a4342ab49b1dd0"><div class="ttname"><a href="classTHSRooFit.html#a579eb4e03f1f6426d9a4342ab49b1dd0">THSRooFit::SetDataWeight</a></div><div class="ttdeci">void SetDataWeight()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8C_source.html#l00224">THSRooFit.C:224</a></div></div>
<div class="ttc" id="classTHSRooFit_html_abcd87f37ed139b7b3f552f91bf01a8f9"><div class="ttname"><a href="classTHSRooFit.html#abcd87f37ed139b7b3f552f91bf01a8f9">THSRooFit::fGotID</a></div><div class="ttdeci">Bool_t fGotID</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00060">THSRooFit.h:60</a></div></div>
<div class="ttc" id="classTHSWeights_html_a27e63290a9634c628ffa55266752554f"><div class="ttname"><a href="classTHSWeights.html#a27e63290a9634c628ffa55266752554f">THSWeights::SetCurrEntry</a></div><div class="ttdeci">void SetCurrEntry(Long64_t ent)</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00054">THSWeights.h:54</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aeafc36ec5e9ccbcea880de858d618879"><div class="ttname"><a href="classTHSRooFit.html#aeafc36ec5e9ccbcea880de858d618879">THSRooFit::fFitOptions</a></div><div class="ttdeci">RooLinkedList fFitOptions</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00070">THSRooFit.h:70</a></div></div>
<div class="ttc" id="classTHSWeights_html_a5446255e1d5bfa7bf7803a32c78cdbca"><div class="ttname"><a href="classTHSWeights.html#a5446255e1d5bfa7bf7803a32c78cdbca">THSWeights::IsSorted</a></div><div class="ttdeci">Bool_t IsSorted()</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8h_source.html#l00056">THSWeights.h:56</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ac31264f23816924d7a99ace58b221799"><div class="ttname"><a href="classTHSRooFit.html#ac31264f23816924d7a99ace58b221799">THSRooFit::fParameters</a></div><div class="ttdeci">RooArgList fParameters</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00039">THSRooFit.h:39</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a2473736cfda53d49f625d6ea4327ac34"><div class="ttname"><a href="classTHSRooFit.html#a2473736cfda53d49f625d6ea4327ac34">THSRooFit::fNStudyTrials</a></div><div class="ttdeci">Int_t fNStudyTrials</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00068">THSRooFit.h:68</a></div></div>
<div class="ttc" id="classTHSsPlot_html_ad6c491e71d3c7cb281fb02f4331b35e1"><div class="ttname"><a href="classTHSsPlot.html#ad6c491e71d3c7cb281fb02f4331b35e1">THSsPlot::GetWeights</a></div><div class="ttdeci">THSWeights * GetWeights()</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00022">THSsPlot.h:22</a></div></div>
<div class="ttc" id="THSsPlot_8h_html"><div class="ttname"><a href="THSsPlot_8h.html">THSsPlot.h</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ac9365ec30ef403e06ca2296c3e268be4"><div class="ttname"><a href="classTHSRooFit.html#ac9365ec30ef403e06ca2296c3e268be4">THSRooFit::fHists</a></div><div class="ttdeci">TList * fHists</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00045">THSRooFit.h:45</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a72856411a5334cd5f9b679b482140594"><div class="ttname"><a href="classTHSRooFit.html#a72856411a5334cd5f9b679b482140594">THSRooFit::AddFitOption</a></div><div class="ttdeci">void AddFitOption(RooCmdArg cmd)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00170">THSRooFit.h:170</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a759b3287f310a63a274140950ee01bfe"><div class="ttname"><a href="classTHSRooFit.html#a759b3287f310a63a274140950ee01bfe">THSRooFit::fAuxVars</a></div><div class="ttdeci">RooArgList fAuxVars</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00035">THSRooFit.h:35</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aedce5610df8f19f7eb09897487aff562"><div class="ttname"><a href="classTHSRooFit.html#aedce5610df8f19f7eb09897487aff562">THSRooFit::SetInWeights</a></div><div class="ttdeci">void SetInWeights(THSWeights *wts)</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00167">THSRooFit.h:167</a></div></div>
<div class="ttc" id="classTHSRooFit_html_a2fa8f2414c4d819d8a2135ace2c19604"><div class="ttname"><a href="classTHSRooFit.html#a2fa8f2414c4d819d8a2135ace2c19604">THSRooFit::GetPDFsp</a></div><div class="ttdeci">RooArgList * GetPDFsp()</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00106">THSRooFit.h:106</a></div></div>
<div class="ttc" id="classTHSRooFit_html_ada0157b88164901f7d75997f57139cbb"><div class="ttname"><a href="classTHSRooFit.html#ada0157b88164901f7d75997f57139cbb">THSRooFit::fInWeights</a></div><div class="ttdeci">THSWeights * fInWeights</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00058">THSRooFit.h:58</a></div></div>
<div class="ttc" id="classTHSsPlot_html_a403aefa2b42cc0723920b8f17432bca8"><div class="ttname"><a href="classTHSsPlot.html#a403aefa2b42cc0723920b8f17432bca8">THSsPlot::SetSPlotRange</a></div><div class="ttdeci">void SetSPlotRange(Double_t min, Double_t max)</div><div class="ttdef"><b>Definition:</b> <a href="THSsPlot_8h_source.html#l00027">THSsPlot.h:27</a></div></div>
<div class="ttc" id="classTHSWeights_html_afb7b3c40654fb77c9adec73b510556e2"><div class="ttname"><a href="classTHSWeights.html#afb7b3c40654fb77c9adec73b510556e2">THSWeights::LoadSaved</a></div><div class="ttdeci">void LoadSaved(TString fname, TString wname)</div><div class="ttdef"><b>Definition:</b> <a href="THSWeights_8C_source.html#l00311">THSWeights.C:311</a></div></div>
<div class="ttc" id="classTHSRooFit_html_aff08fd318d929eb3b6b3e5087b487879"><div class="ttname"><a href="classTHSRooFit.html#aff08fd318d929eb3b6b3e5087b487879">THSRooFit::fVariables</a></div><div class="ttdeci">RooArgList fVariables</div><div class="ttdef"><b>Definition:</b> <a href="THSRooFit_8h_source.html#l00034">THSRooFit.h:34</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 10 2017 13:45:58 for HASPECT6 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
