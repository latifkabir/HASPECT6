<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HASPECT6: HaSpect/THSPartOutput.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HASPECT6
   </div>
   <div id="projectbrief">Hadron spectroscopy data analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3ca80ef9e5877ea9d11d1a324ddaa5cd.html">HaSpect</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">THSPartOutput.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="THSPartOutput_8C.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="THSPartOutput_8h.html">THSPartOutput.h</a>&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="classTHSPartOutput.html#adefec9d9285f15806d839cc9568203f8">    3</a></span>&#160;<a class="code" href="classTHSPartOutput.html#adefec9d9285f15806d839cc9568203f8">THSPartOutput::~THSPartOutput</a>(){</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  <span class="comment">//clear THSParticles memory</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  <span class="keywordflow">for</span>(UInt_t i=0;i&lt;<a class="code" href="classTHSPartOutput.html#a13bac7753a533c186bd10e9eb0e67d7b">fDetParticle</a>.size();i++)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    SafeDelete(<a class="code" href="classTHSPartOutput.html#a13bac7753a533c186bd10e9eb0e67d7b">fDetParticle</a>[i]);</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;}</div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="classTHSPartOutput.html#a20dd9ca8a82fcd4e09b5c8e5abf0a001">    9</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSPartOutput.html#a20dd9ca8a82fcd4e09b5c8e5abf0a001">THSPartOutput::InitOutput</a>(){</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="comment">//used the predefined string in fStrParticles to setup output tree branches</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; <span class="comment">//Make output Tree   </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;   <span class="keywordflow">if</span>(!<a class="code" href="classTHSOutput.html#ad04048d77720e3c4d255e925e1a30e6e">fOutTree</a>) <a class="code" href="classTHSOutput.html#ad04048d77720e3c4d255e925e1a30e6e">fOutTree</a>=<span class="keyword">new</span> TTree(<span class="stringliteral">&quot;HSParticles&quot;</span>,<span class="stringliteral">&quot;A tree containing reconstructed particles&quot;</span>);</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  Int_t buff=64000;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  Int_t split=0;<span class="comment">//note split is important in the TSelector framework, if increased branches in subsequent selectors will be data members of the THSParticle object rather than the whole object (this can lead to name conflicts)</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;   </div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;   <span class="comment">//now automatically create requested detected particles</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   <span class="comment">//Get the final state defined in fStrParticles</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   <a class="code" href="classTHSPartOutput.html#a9ccda18ee24e78409419974fd7956e0f">fNdet</a>=<a class="code" href="classTHSOutput.html#a82d70c22fb90dd0295a938ada663e5fa">CountChar</a>(<a class="code" href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">fStrParticles</a>,<span class="charliteral">&#39;:&#39;</span>)+1; <span class="comment">//number of particles is just &quot;number of :&quot; +1</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   Int_t pos=0;<span class="comment">//marker for position in particle list string</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordflow">for</span>(UInt_t ifs=0;ifs&lt;<a class="code" href="classTHSPartOutput.html#a9ccda18ee24e78409419974fd7956e0f">fNdet</a>;ifs++){<span class="comment">//loop over fStrParticles string and seperate particles</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;     TString pName;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">fStrParticles</a>.Index(<span class="stringliteral">&quot;:&quot;</span>,pos+1)&gt;0)pName=<a class="code" href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">fStrParticles</a>(pos,<a class="code" href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">fStrParticles</a>.Index(<span class="stringliteral">&quot;:&quot;</span>,pos+1)-pos);<span class="comment">//split the fStrParticles string</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;     <span class="keywordflow">else</span> pName=<a class="code" href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">fStrParticles</a>(pos,<a class="code" href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">fStrParticles</a>.Length()-pos);<span class="comment">//no more &#39;:&#39; so last particle</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;     pos=<a class="code" href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">fStrParticles</a>.Index(<span class="stringliteral">&quot;:&quot;</span>,pos+1)+1;<span class="comment">//move pos on to the next particle</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;     <a class="code" href="classTHSPartOutput.html#a4eb588bc1a22b0df0bf7f85ad570d859">fDetID</a>.push_back(TDatabasePDG::Instance()-&gt;GetParticle(pName)-&gt;PdgCode());<span class="comment">//get PDG code for particle</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;     <a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>.push_back(<a class="code" href="classTHSPartOutput.html#a4eb588bc1a22b0df0bf7f85ad570d859">fDetID</a>[ifs]); <span class="comment">//save ID in fFinalState to compare each event with</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="comment">//order the final state vector, allows easy comparison with event vector, this is ascending order</span><span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   //!!!!!!!!!!!!!!!!!!!!!!very important step for event algorithm!!!!!!!!!!</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span>   std::sort(<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>.begin(),<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>.end());</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="comment">//sort the number of different particle types into fNtype</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   Int_t vipart=0;<span class="comment">//counter to move to next particle type in fFinalState</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   Int_t nvipart=0;<span class="comment">//counter of number of particle types</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="keywordflow">while</span>((nvipart=std::count(<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>.begin(),<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>.end(),<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>[vipart]))){<a class="code" href="classTHSPartOutput.html#a9eb8cefc25bf95e4ff6db345b231218a">fNtype</a>.push_back(nvipart);vipart+=nvipart;}</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">//now make the branches and particles</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   UInt_t Nbranches=0;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   vipart=0;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="keywordflow">for</span>(UInt_t itype=0;itype&lt;<a class="code" href="classTHSPartOutput.html#a9eb8cefc25bf95e4ff6db345b231218a">fNtype</a>.size();itype++){<span class="comment">//loop over types of particles</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;     <a class="code" href="classTHSPartOutput.html#aef76891d61906ff4fab8365f9f8c852b">fIDtype</a>.push_back(<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>[Nbranches]);<span class="comment">//get the pdg id of this type</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;     <span class="keywordflow">for</span>(UInt_t intype=0;intype&lt;<a class="code" href="classTHSPartOutput.html#a9eb8cefc25bf95e4ff6db345b231218a">fNtype</a>[itype];intype++){<span class="comment">//loop over particles of same type</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;       <span class="comment">//create particles, note the vector will look after deleting these when it goes out of scope</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;       <a class="code" href="classTHSPartOutput.html#a13bac7753a533c186bd10e9eb0e67d7b">fDetParticle</a>.push_back(<span class="keyword">new</span> <a class="code" href="classTHSParticle.html">THSParticle</a>(<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>[Nbranches]));</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;       TString pName=TDatabasePDG::Instance()-&gt;GetParticle(<a class="code" href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">fFinalState</a>[Nbranches])-&gt;GetName();</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       pName.ReplaceAll(<span class="stringliteral">&quot;+&quot;</span>,<span class="stringliteral">&quot;p&quot;</span>);  <span class="comment">//Get rid of + and - in names so not to confuse tree-&gt;Draw</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;       pName.ReplaceAll(<span class="stringliteral">&quot;-&quot;</span>,<span class="stringliteral">&quot;m&quot;</span>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;       pName+=TString(<span class="stringliteral">&quot;_&quot;</span>)+=intype;<span class="comment">//append the number of instance of this particle to PDG name</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;       <a class="code" href="classTHSOutput.html#ad04048d77720e3c4d255e925e1a30e6e">fOutTree</a>-&gt;Branch(pName,<a class="code" href="classTHSPartOutput.html#a13bac7753a533c186bd10e9eb0e67d7b">fDetParticle</a>[Nbranches],buff,split); <span class="comment">//make the branch</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       cout&lt;&lt;<span class="stringliteral">&quot;Made branch &quot;</span>&lt;&lt;pName&lt;&lt;<span class="stringliteral">&quot; the particle can be accessed in the code with fDetParticle[&quot;</span>&lt;&lt;Nbranches&lt;&lt;<span class="stringliteral">&quot;]&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;       Nbranches++;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;     }<span class="comment">//end intype loop</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   }<span class="comment">//end itype loop</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div><div class="ttc" id="THSPartOutput_8h_html"><div class="ttname"><a href="THSPartOutput_8h.html">THSPartOutput.h</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_aef76891d61906ff4fab8365f9f8c852b"><div class="ttname"><a href="classTHSPartOutput.html#aef76891d61906ff4fab8365f9f8c852b">THSPartOutput::fIDtype</a></div><div class="ttdeci">vector&lt; UInt_t &gt; fIDtype</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8h_source.html#l00034">THSPartOutput.h:34</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_a20dd9ca8a82fcd4e09b5c8e5abf0a001"><div class="ttname"><a href="classTHSPartOutput.html#a20dd9ca8a82fcd4e09b5c8e5abf0a001">THSPartOutput::InitOutput</a></div><div class="ttdeci">virtual void InitOutput()</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8C_source.html#l00009">THSPartOutput.C:9</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_abb63e603c22bf8769bade2d124fb59f9"><div class="ttname"><a href="classTHSPartOutput.html#abb63e603c22bf8769bade2d124fb59f9">THSPartOutput::fFinalState</a></div><div class="ttdeci">vector&lt; Int_t &gt; fFinalState</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8h_source.html#l00032">THSPartOutput.h:32</a></div></div>
<div class="ttc" id="classTHSParticle_html"><div class="ttname"><a href="classTHSParticle.html">THSParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00021">THSParticle.h:21</a></div></div>
<div class="ttc" id="classTHSOutput_html_a82d70c22fb90dd0295a938ada663e5fa"><div class="ttname"><a href="classTHSOutput.html#a82d70c22fb90dd0295a938ada663e5fa">THSOutput::CountChar</a></div><div class="ttdeci">Int_t CountChar(TString tests, char testc)</div><div class="ttdef"><b>Definition:</b> <a href="THSOutput_8C_source.html#l00475">THSOutput.C:475</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_a9eb8cefc25bf95e4ff6db345b231218a"><div class="ttname"><a href="classTHSPartOutput.html#a9eb8cefc25bf95e4ff6db345b231218a">THSPartOutput::fNtype</a></div><div class="ttdeci">vector&lt; UInt_t &gt; fNtype</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8h_source.html#l00033">THSPartOutput.h:33</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_a4eb588bc1a22b0df0bf7f85ad570d859"><div class="ttname"><a href="classTHSPartOutput.html#a4eb588bc1a22b0df0bf7f85ad570d859">THSPartOutput::fDetID</a></div><div class="ttdeci">vector&lt; Int_t &gt; fDetID</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8h_source.html#l00036">THSPartOutput.h:36</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_a13bac7753a533c186bd10e9eb0e67d7b"><div class="ttname"><a href="classTHSPartOutput.html#a13bac7753a533c186bd10e9eb0e67d7b">THSPartOutput::fDetParticle</a></div><div class="ttdeci">vector&lt; THSParticle * &gt; fDetParticle</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8h_source.html#l00037">THSPartOutput.h:37</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_a9ccda18ee24e78409419974fd7956e0f"><div class="ttname"><a href="classTHSPartOutput.html#a9ccda18ee24e78409419974fd7956e0f">THSPartOutput::fNdet</a></div><div class="ttdeci">UInt_t fNdet</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8h_source.html#l00035">THSPartOutput.h:35</a></div></div>
<div class="ttc" id="classTHSPartOutput_html_adefec9d9285f15806d839cc9568203f8"><div class="ttname"><a href="classTHSPartOutput.html#adefec9d9285f15806d839cc9568203f8">THSPartOutput::~THSPartOutput</a></div><div class="ttdeci">~THSPartOutput()</div><div class="ttdef"><b>Definition:</b> <a href="THSPartOutput_8C_source.html#l00003">THSPartOutput.C:3</a></div></div>
<div class="ttc" id="classTHSOutput_html_ad04048d77720e3c4d255e925e1a30e6e"><div class="ttname"><a href="classTHSOutput.html#ad04048d77720e3c4d255e925e1a30e6e">THSOutput::fOutTree</a></div><div class="ttdeci">TTree * fOutTree</div><div class="ttdef"><b>Definition:</b> <a href="THSOutput_8h_source.html#l00033">THSOutput.h:33</a></div></div>
<div class="ttc" id="classTHSOutput_html_af7945118d52a1c6ba99a792a3dd4a8e4"><div class="ttname"><a href="classTHSOutput.html#af7945118d52a1c6ba99a792a3dd4a8e4">THSOutput::fStrParticles</a></div><div class="ttdeci">TString fStrParticles</div><div class="ttdef"><b>Definition:</b> <a href="THSOutput_8h_source.html#l00037">THSOutput.h:37</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 10 2017 13:45:58 for HASPECT6 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
