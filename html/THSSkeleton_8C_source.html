<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HASPECT6: HaSpect/THSSkeleton.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HASPECT6
   </div>
   <div id="projectbrief">Hadron spectroscopy data analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3ca80ef9e5877ea9d11d1a324ddaa5cd.html">HaSpect</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">THSSkeleton.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="THSSkeleton_8C.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> \class THSSkeleton</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> Class to generate selector code</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> based on TTree::MakeSelector()</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> @example MakeHSSelector.C</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="THSSkeleton_8h.html">THSSkeleton.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;RooClassFactory.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;TSystem.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">///Create intial selector code from TTree::MakeSelector()</span></div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a3c8d74447096c00b4a78796d44d996b9">   20</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a3c8d74447096c00b4a78796d44d996b9">THSSkeleton::CreateSelector</a>(TString selname,TString filename,TString treename,TString opt){</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  fSelName=selname;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  fFileName=filename;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  fTreeName=treename;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  fOption=opt;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  fFile=TFile::Open(fFileName);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">if</span>(!fFile)</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    Fatal(<span class="stringliteral">&quot;THSSkeleton::THSkeleton(TString filename,TString treename)&quot;</span>,<span class="stringliteral">&quot;No file %s found&quot;</span>,fFileName.Data());</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  fTree=(TTree*)fFile-&gt;Get(fTreeName);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span>(!fTree)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    Fatal(<span class="stringliteral">&quot;THSSkeleton::THSkeleton(TString filename,TString treename)&quot;</span>,<span class="stringliteral">&quot;No tree %s found&quot;</span>,fTreeName.Data());</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">//check if skelton code exists already</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  TString selfile=fSelName+<span class="stringliteral">&quot;.C&quot;</span>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  TString sOverwrite;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span>(gSystem-&gt;FindFile(<span class="stringliteral">&quot;./&quot;</span>,selfile)){Info(<span class="stringliteral">&quot;THSSkeleton::THSkeleton(TString filename,TString treename)&quot;</span>,<span class="stringliteral">&quot;Selector Code already exists to exit type y&quot;</span>);cin&gt;&gt;sOverwrite;};</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">if</span>(sOverwrite==TString(<span class="stringliteral">&quot;y&quot;</span>)) exit(0);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">//fTree-&gt;MakeSelector(fSelName);</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span>(fIsFinalState)fOption+=<span class="stringliteral">&quot;=legacy&quot;</span>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  fTree-&gt;MakeSelector(fSelName,fOption);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  fMadeSelector=kTRUE;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  AddHSOutput();</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a2dca73eeb476f503d006aa033c263437">   47</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a2dca73eeb476f503d006aa033c263437">THSSkeleton::AddHSOutput</a>(){</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  fPlace=0;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  HSOut_C();</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  HSOut_h();</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  HSOut_Control();</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span>(fIsHisto) HSHisto();</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">if</span>(fIsAppendTree) HSAppend();</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span>(fIsNewTree) HSNewTree();</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">if</span>(fIsWeights) HSWeights();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span>(fNLPS) HSLPS();</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span>(fIsFinalState) HSFinalState();</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// AddLineAfter(,,1);</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">// AddLineAfter(,,1);</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// AddLineAfter(,,1);</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// AddLineAfter(,,1);</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// AddLineAfter(,,1);</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// AddLineAfter(,,1);</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#af27bb23d70a6f6672066fa8290f65643">   69</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#af27bb23d70a6f6672066fa8290f65643">THSSkeleton::HSOut_C</a>(){</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//Open source code as macro</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">//Note bug in TMacro, where it does not read final }character so add it here</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">//May cause issues on different systems....</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  TList* lines=fCurMacro.GetListOfLines();</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">if</span>(!((TObjString*)lines-&gt;Last())-&gt;String().Contains(<span class="stringliteral">&quot;}&quot;</span>)){</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    fPlace=fCurMacro.GetListOfLines()-&gt;GetEntries();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    fPlace=0;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">//End bug fix</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">//second bug fix</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">//TTreeReader should call SetEntryLocal for chains</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; <span class="keywordflow">if</span>(!fOption.Contains(<span class="stringliteral">&quot;legacy&quot;</span>))  ReplaceMacroText(<span class="stringliteral">&quot;fReader.SetEntry&quot;</span>,<span class="stringliteral">&quot;fReader.SetLocalEntry&quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">//First add shadow Selector function calls</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;::Begin(TTree * /*tree*/)&quot;</span>,<span class="stringliteral">&quot;   THSOutput::HSBegin(fInput,fOutput);&quot;</span>,1);<span class="comment">//off=1 to get past { line</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span>(fOption.Contains(<span class="stringliteral">&quot;legacy&quot;</span>))AddLineAfter(<span class="stringliteral">&quot;::Process(Long64_t entry)&quot;</span>,<span class="stringliteral">&quot;   THSOutput::HSProcessStart(entry);&quot;</span>,1);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">else</span> AddLineAfter(<span class="stringliteral">&quot;fReader.Set&quot;</span>,<span class="stringliteral">&quot;   THSOutput::HSProcessStart(entry);&quot;</span>,0);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;::SlaveTerminate()&quot;</span>,<span class="stringliteral">&quot;   THSOutput::HSSlaveTerminate();&quot;</span>,1);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;::Terminate()&quot;</span>,<span class="stringliteral">&quot;   THSOutput::HSTerminate();&quot;</span>,1);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">//Case of SlaveBegin, we want to have TString option=GetOPtion line first</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  MoveToLine(<span class="stringliteral">&quot;::SlaveBegin(TTree * /*tree*/)&quot;</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;TString option = GetOption();&quot;</span>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   THSOutput::HSSlaveBegin(fInput,fOutput);&quot;</span>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  MoveToLine(<span class="stringliteral">&quot;::Process(Long64_t entry)&quot;</span>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;return kTRUE;&quot;</span>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   THSOutput::HSProcessFill();&quot;</span>,-1);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span>(fOption.Contains(<span class="stringliteral">&quot;legacy&quot;</span>))AddLineAfter(<span class="stringliteral">&quot;HSProcessStart&quot;</span>,<span class="stringliteral">&quot;   GetEntry(entry);&quot;</span>,-1);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a24352664eaa32dba6b83886659abc2bd">  105</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a24352664eaa32dba6b83886659abc2bd">THSSkeleton::HSOut_h</a>(){</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">//Open source code as macro</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;#include &lt;TSelector.h&gt;&quot;</span>,<span class="stringliteral">&quot;#include \&quot;THSOutput.h\&quot;&quot;</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;::Notify()&quot;</span>,<span class="stringliteral">&quot;   THSOutput::HSNotify(fChain);&quot;</span>,1);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span>(!fOption.Contains(<span class="stringliteral">&quot;legacy&quot;</span>))AddLineAfter(<span class="stringliteral">&quot;::Notify()&quot;</span>,<span class="stringliteral">&quot;   fChain=fReader.GetTree();&quot;</span>,1);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  </div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// AddLineAfter(,,1);</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  ReplaceMacroText(<span class="stringliteral">&quot;public TSelector&quot;</span>,<span class="stringliteral">&quot;public TSelector, public THSOutput&quot;</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a4d307de89e4fcbf665c6809dace1793f">  119</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a4d307de89e4fcbf665c6809dace1793f">THSSkeleton::HSOut_Control</a>(){</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  fPlace=0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  TString HSANA=gSystem-&gt;Getenv(<span class="stringliteral">&quot;HSANA&quot;</span>);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">//Open a template file </span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  fCurMacro=TMacro(HSANA+<span class="stringliteral">&quot;/Control_Template.C&quot;</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  ReplaceMacroText(<span class="stringliteral">&quot;INPUT_FILE_DIR&quot;</span>,TString(gSystem-&gt;DirName(fFileName))+<span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  ReplaceMacroText(<span class="stringliteral">&quot;TREENAME&quot;</span>,fTreeName);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  ReplaceMacroText(<span class="stringliteral">&quot;FILENAMES&quot;</span>,gSystem-&gt;BaseName(fFileName));</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  ReplaceMacroText(<span class="stringliteral">&quot;SELECTOR&quot;</span>,fSelName+<span class="stringliteral">&quot;.C++&quot;</span>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  fCurMacro.SaveSource(TString(<span class="stringliteral">&quot;Control_&quot;</span>)+fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">/////////////////////////////////////////////</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/// Add examples of how to use the</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/// THSHisto class</span></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#acddda64b12f713fc81445f44fdfe5d07">  137</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#acddda64b12f713fc81445f44fdfe5d07">THSSkeleton::HSHisto</a>(){</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  fPlace=0;<span class="comment"></span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span>  <span class="comment">//First deal with .C</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;GetOption();&quot;</span>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">//Define bins if wanted</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;//If you want to split histograms into different kinematic bins, include and configure the lines below&quot;</span>);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;//   fBins=new THSBins(\&quot;HSBins\&quot;);&quot;</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;//   fBins-&gt;AddAxis(\&quot;AXIS1NAME\&quot;,10,-1,1);&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;//   fBins-&gt;AddAxis(\&quot;AXIS2NAME\&quot;,10,-1,1);&quot;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;//   if(!fInput) fInput=new TList();&quot;</span>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;//   fInput-&gt;Add(fBins);&quot;</span>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  </div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSSlaveBegin(fInput,fOutput);&quot;</span>,<span class="stringliteral">&quot;  //Initialise and configure histogramming&quot;</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   THSHisto::InitialiseHisto(fInput);&quot;</span>);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   THSHisto::LoadCut(\&quot;Cut1\&quot;);&quot;</span>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   THSHisto::LoadHistograms();&quot;</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">//Now fill histograms in process</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSProcessFill();&quot;</span>,<span class="stringliteral">&quot; //below you can give vars corresponding to fBins axis&quot;</span>,-2);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //if(fBins) fCurrBin=fBins-&gt;FindBin(var1,var2,...);//if fBins is defined need to give this meaningful arguments&quot;</span>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   FillHistograms(\&quot;Cut1\&quot;);&quot;</span>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">//Now add new functions at end of file</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  fPlace=fCurMacro.GetListOfLines()-&gt;GetEntries()+1;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  ContinueLineAfter(TString(<span class="stringliteral">&quot;void &quot;</span>)+fSelName+<span class="stringliteral">&quot;::HistogramList(TString sLabel){&quot;</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  TDirectory::AddDirectory(kFALSE); //do not add to current directory&quot;</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //now define all histograms and add to Output&quot;</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //label includes kinematic bin and additional cut name&quot;</span>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  // e.g fOutput-&gt;Add(MapHist(new TH1F(\&quot;Mp1\&quot;,\&quot;M_{p1}\&quot;,100,0,2)));&quot;</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //end of histogram list&quot;</span>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  TDirectory::AddDirectory(kTRUE); //back to normal&quot;</span>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  ContinueLineAfter(TString(<span class="stringliteral">&quot;void &quot;</span>)+fSelName+<span class="stringliteral">&quot;::FillHistograms(TString sCut){&quot;</span>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  if(fBins&amp;&amp;fCurrBin==-1) return; //Outwith bin limits so no hists&quot;</span>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  fCurrCut=sCut;&quot;</span>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //Get histogram from list&quot;</span>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //Fill histogram&quot;</span>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  // e.g. FindHist(\&quot;Mp1\&quot;)-&gt;Fill(fp1-&gt;M());//1D&quot;</span>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  // e.g. ((TH2D*)FindHist(\&quot;Mp1\&quot;))-&gt;Fill(fp1-&gt;M(),fp2-&gt;M());//2D&quot;</span>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">// ContinueLineAfter();</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span>  <span class="comment">//Now with .h</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  fPlace=0;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;virtual void    Terminate();&quot;</span>,<span class="stringliteral">&quot;//Add THSHisto functions&quot;</span>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   virtual void HistogramList(TString sLabel);&quot;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   virtual void FillHistograms(TString sCut);&quot;</span>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/// Adds examples of how to append branches to the input</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/// to the input tree.</span></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#af2297529dd6e2c45ce5d569173611416">  196</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#af2297529dd6e2c45ce5d569173611416">THSSkeleton::HSAppend</a>(){</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span>(fIsNewTree)Error(<span class="stringliteral">&quot;THSSkeleton::HSNewTree()&quot;</span>,<span class="stringliteral">&quot;Can&#39;t have a new tree and an append tree!&quot;</span>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  fPlace=0;<span class="comment"></span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span>  <span class="comment">//First deal with .h</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSNotify(fChain);&quot;</span>,<span class="stringliteral">&quot;  //If we want to clone the input tree we have to do it here as fChain does not exist in SlaveBegin on PROOF&quot;</span>);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  if(!fOutTree){//First file, clone the input tree and add branches&quot;</span>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   Int_t buff=32000;&quot;</span>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   Int_t split=0;//note split is important in the TSelector framework, if increased branches in subsequent selectors will be data members of the THSParticle object rather than the whole object (this can lead to name conflicts)&quot;</span>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;    fOutTree=fChain-&gt;CloneTree(0);&quot;</span>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;    //e.g. fp1=new TLorentzVector(); //should be declared as class data member&quot;</span>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;    //e.g. fOutTree-&gt;Branch(\&quot;p1\&quot;,&amp;fp1,buff,split);&quot;</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  }&quot;</span>);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  else {fChain-&gt;CopyAddresses(fOutTree);}//reset the branch addresses of the cloned tree to the new file tree&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  THSOutput::InitOutTree();&quot;</span>);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;TTree          *fChain&quot;</span>,<span class="stringliteral">&quot;  //data members for new branches&quot;</span>,1);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //you must define how they are processed for each event and set to 0 in constructor&quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //e.g.   TLorentzVector  *fp1;&quot;</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   TString sline=fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;GetString();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   sline.ReplaceAll(<span class="stringliteral">&quot;{&quot;</span>,<span class="stringliteral">&quot;{/*SafeDelete(fp1);//If we add pointer ro classmust delete it*/ &quot;</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;SetString(sline);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"></span>  <span class="comment">//Now with .C</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">/// Adds example of how to create a new output tree</span></div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a0c5f959f20a777e42fe683ce1b62142b">  229</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a0c5f959f20a777e42fe683ce1b62142b">THSSkeleton::HSNewTree</a>(){</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">if</span>(fIsAppendTree)Error(<span class="stringliteral">&quot;THSSkeleton::HSNewTree()&quot;</span>,<span class="stringliteral">&quot;Can&#39;t have a new tree and an append tree!&quot;</span>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  fPlace=0;<span class="comment"></span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span>  <span class="comment">//First deal with .C</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSSlaveBegin(fInput,fOutput);&quot;</span>,<span class="stringliteral">&quot;  //Initialise the ouput tree&quot;</span>);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">//ContinueLineAfter(&quot;   Int_t buff=32000;&quot;);</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// ContinueLineAfter(&quot;   Int_t split=0;//note split is important in the TSelector framework, if increased branches in subsequent selectors will be data members of the THSParticle object rather than the whole object (this can lead to name conflicts)&quot;);</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //Only done once. THSOutput::FinishOutput Resets the tree before new files&quot;</span>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //If you want to save additional branches to a new file, do it here&quot;</span>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //If you are creating a HSParticle tree via fStrParticles then do not create a new tree here, just add the extra branches&quot;</span>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   fOutTree=new TTree(\&quot;HSParticles\&quot;,\&quot;A tree containing reconstructed particles\&quot;); &quot;</span>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //e.g. Make some objects to make branch with, these should be declared in the .h file &quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //e.g. fp1=new TLorentzVector();&quot;</span>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  //e.g.  fOutTree-&gt;Branch(\&quot;p1\&quot;,&amp;fp1,buff,split);&quot;</span>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span>  <span class="comment">//Now with .h</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;TTree          *fChain&quot;</span>,<span class="stringliteral">&quot;  //data members for new branches&quot;</span>,1);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //you must define how they are processed for each event and set to 0 in constructor&quot;</span>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //e.g.   TLorentzVector  *fp1;&quot;</span>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  TString sline=fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;GetString();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  sline.ReplaceAll(<span class="stringliteral">&quot;{&quot;</span>,<span class="stringliteral">&quot;{/*//SafeDelete(fp1);//If we add pointer ro classmust delete it*/ &quot;</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;SetString(sline);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  AddLineAfter( <span class="stringliteral">&quot;THSOutput::HSNotify(fChain);&quot;</span>,<span class="stringliteral">&quot;  THSOutput::InitOutTree();&quot;</span>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">/// Adds example of how to use the THSWeights class.</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a46b824d511a6c8650f2cd4e9ec1c893e">  269</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a46b824d511a6c8650f2cd4e9ec1c893e">THSSkeleton::HSWeights</a>(){</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  fPlace=0;<span class="comment"></span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span>  <span class="comment">//First deal with .C</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">//Load Weights</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSSlaveBegin(fInput,fOutput);&quot;</span>,<span class="stringliteral">&quot;   //Get weights from file&quot;</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   THSHisto::LoadWeights(\&quot;WEIGHTFILE_DIR+NAME\&quot;,\&quot;WEIGHTNAME\&quot;);&quot;</span>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">//Use weights for histogramming</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">if</span>(fIsHisto){</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;THSHisto::InitialiseHisto&quot;</span>,<span class="stringliteral">&quot;   //Load histograms for each species that has a weight&quot;</span>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;   THSHisto::LoadCutsForWeights(); //Loop over weights species and make weighted histograms for each&quot;</span>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;FillHistograms(\&quot;Cut1\&quot;);&quot;</span>,<span class="stringliteral">&quot;   fWeight=1; //For unweighted histograms&quot;</span>,-2);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSProcessFill();&quot;</span>,<span class="stringliteral">&quot;   THSHisto::GetWeightEvent(fgID); //get weights for this event, use fgID as works when permutating also&quot;</span>,-2);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;   THSHisto::FillCutsForWeights(); //Fill weighted hists&quot;</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;// e.g. ((TH2D*)FindHist(\&quot;Mp1\&quot;))&quot;</span>,<span class="stringliteral">&quot;  //Find and fill weighted hist below here&quot;</span>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;  //e.g. FindHist(\&quot;Mp1\&quot;)-&gt;Fill(fp1-&gt;M(),fWeight);&quot;</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;  //e.g. ((TH2F*)FindHist(\&quot;Mp1VMmiss\&quot;))-&gt;Fill(fp1-&gt;M(),Mmiss,fWeight);&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    ReplaceMacroText(<span class="stringliteral">&quot;// e.g. ((TH2D*)FindHist(\&quot;Mp1\&quot;))-&gt;Fill(fp1-&gt;M(),fp2-&gt;M());//2D&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    ReplaceMacroText(<span class="stringliteral">&quot;// e.g. FindHist(\&quot;Mp1\&quot;)-&gt;Fill(fp1-&gt;M());//1D&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    </div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">//ContinueLineAfter();</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span>  <span class="comment">//Now with .h</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;#include \&quot;THSOutput.h\&quot;&quot;</span>,<span class="stringliteral">&quot;#include \&quot;THSWeights.h\&quot;&quot;</span>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;TTree          *fChain&quot;</span>,<span class="stringliteral">&quot;  //data members for reading weights&quot;</span>,1);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   THSWeights* fWeights=0;&quot;</span>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  TString sline=fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;GetString();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  sline.ReplaceAll(<span class="stringliteral">&quot;{&quot;</span>,<span class="stringliteral">&quot;{SafeDelete(fWeights); &quot;</span>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;SetString(sline);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// //Now with Control</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// fCurMacro=TMacro(TString(&quot;Control_&quot;)+fSelName+&quot;.C&quot;);</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// TString cline=fCurMacro.GetLineWith(&quot;tree-&gt;Process(&quot;)-&gt;GetString();</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// cline.ReplaceAll(&quot;)&quot;,&quot;,\&quot;WEIGHTSFILEHERE.root:NameOfWeightsObject\&quot;)&quot;);</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// fCurMacro.GetLineWith(&quot;tree-&gt;Process(&quot;)-&gt;SetString(cline);</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// fCurMacro.SaveSource(TString(&quot;Control_&quot;)+fSelName+&quot;.C&quot;);</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/// Adds example of how to use the THSLongPS class.</span></div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#afc6babad73c297fe9e0cb808226525b9">  323</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#afc6babad73c297fe9e0cb808226525b9">THSSkeleton::HSLPS</a>(){</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  fPlace=0;<span class="comment"></span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span>  <span class="comment">//First deal with .C</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSSlaveBegin(fInput,fOutput);&quot;</span>,<span class="stringliteral">&quot;   //Construct the LongPS object with number of particles in final state&quot;</span>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">//TString strLPS;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">//strLPS.Form(&quot;   fLPS=new THSLongPS(%d);&quot;,NLPS);</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  ContinueLineAfter(Form(<span class="stringliteral">&quot;   fLPS=new THSLongPS(%d);&quot;</span>,fNLPS));</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSProcessStart(entry)&quot;</span>,<span class="stringliteral">&quot;   fLPS-&gt;Reset();&quot;</span>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   //below you need to give the final state TLorentzVectors to fLPS. Replace ? by the TLorentzVector object. The order gives the particle indice for the sectors&quot;</span>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span>(Int_t ii=0;ii&lt;fNLPS;ii++)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;   fLPS-&gt;AddParticle(?);&quot;</span>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  </div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   fLPS-&gt;Analyse();&quot;</span>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   fLPS-&gt;GetSector();//Can use the sector number now etc.&quot;</span>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span>  <span class="comment">//Now with .h</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;#include \&quot;THSOutput.h\&quot;&quot;</span>,<span class="stringliteral">&quot;#include \&quot;THSLongPS.h\&quot;&quot;</span>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;TTree          *fChain&quot;</span>,<span class="stringliteral">&quot;   THSLongPS* fLPS=0;&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  TString sline=fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;GetString();</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  sline.ReplaceAll(<span class="stringliteral">&quot;{&quot;</span>,<span class="stringliteral">&quot;{SafeDelete(fLPS); &quot;</span>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  fCurMacro.GetLineWith(<span class="stringliteral">&quot;virtual ~&quot;</span>)-&gt;SetString(sline);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">/// Adds examples of how to include an analysis project</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">/// like e.g. THSFinalTemp.C</span></div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#aa6586db59b377db06e046fca5af294ee">  359</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#aa6586db59b377db06e046fca5af294ee">THSSkeleton::HSFinalState</a>(){</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  fPlace=0;<span class="comment"></span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span>  <span class="comment">//First deal with .C</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">if</span>(fIsFinalStatePerm){</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSSlaveBegin(fInput,fOutput);&quot;</span>,<span class="stringliteral">&quot;   SetPermutate();//will permutate like particles&quot;</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// AddLineAfter(&quot;// The return value is currently not used.&quot;,&quot;   fgIDoff=1E10;//offset in &gt;1 permutation of particles&quot;);</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;// The return value is currently not used.&quot;</span>,<span class="stringliteral">&quot;   InitEvent();&quot;</span>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;   do{//In case there is a permutation of particles&quot;</span>));</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;     &quot;</span>)+fFinalName+<span class="stringliteral">&quot;::WorkOnEvent();&quot;</span>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;     if(!THSFinalState::fGoodEvent) continue;//Don&#39;t fill anything,User should determine value for fGoodEvent in their project&quot;</span>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;THSOutput::HSProcessFill();&quot;</span>,<span class="stringliteral">&quot;   }&quot;</span>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;   while(THSFinalState::IsPermutating());&quot;</span>));</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;// The return value is currently not used.&quot;</span>,TString(<span class="stringliteral">&quot;   &quot;</span>)+fFinalName+<span class="stringliteral">&quot;::WorkOnEvent();&quot;</span>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;   if(!fGoodEvent) return kTRUE;//Don&#39;t fill anything,User should determine value for fGoodEvent in their project&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">//If newtree need to link project tree</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span>(fIsNewTree){</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    AddLineAfter(<span class="stringliteral">&quot;fOutTree=new TTree&quot;</span>,TString(<span class="stringliteral">&quot;   &quot;</span>)+fFinalName+<span class="stringliteral">&quot;::FinalStateOutTree(fOutTree);&quot;</span>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.C&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span>  <span class="comment">//Now with .h</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  fCurMacro=TMacro(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;#include \&quot;THSOutput.h\&quot;&quot;</span>,TString(<span class="stringliteral">&quot;#include \&quot;&quot;</span>)+fFinalName+<span class="stringliteral">&quot;.h\&quot;&quot;</span>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  ReplaceMacroText(<span class="stringliteral">&quot;public THSOutput&quot;</span>,TString(<span class="stringliteral">&quot;public THSOutput, public &quot;</span>)+fFinalName);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// TString branch=FindNextLineLike(&quot;TTreeReaderArray&lt;THSParticle&gt;&quot;);</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// if(branch.Contains(&quot;\&quot;Particles\&quot;&quot;)) AddLineAfter(&quot;   fReader.SetTree(tree);&quot;,&quot;   THSFinalState::SetDetParts(&amp;Particles);&quot;);</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// if(branch.Contains(&quot;\&quot;Generated\&quot;&quot;)){</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">//   AddLineAfter(&quot;   fReader.SetTree(tree);&quot;,&quot;   if(!tree-&gt;GetBranchStatus(\&quot;Generated\&quot;))Generated.~TTreeReaderArray();//Not sim remove Generated branch&quot;);</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">//   ContinueLineAfter(&quot;   else THSFinalState::SetGenParts(&amp;Generated);&quot;);</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">//  fPlace=1; //move bakc to start</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// branch=FindNextLineLike(&quot;TTreeReaderArray&lt;THSParticle&gt;&quot;);</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// fPlace++;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// branch=FindNextLineLike(&quot;TTreeReaderArray&lt;THSParticle&gt;&quot;); //Not good coding! but need oto fin the second one</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// if(branch.Contains(&quot;\&quot;Particles\&quot;&quot;)) AddLineAfter(&quot;   fReader.SetTree(tree);&quot;,&quot;   THSFinalState::SetDetParts(&amp;Particles);&quot;);</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// if(branch.Contains(&quot;\&quot;Generated\&quot;&quot;)){</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">//   AddLineAfter(&quot;   fReader.SetTree(tree);&quot;,&quot;   if(!tree-&gt;GetBranchStatus(\&quot;Generated\&quot;))Generated.~TTreeReaderArray();//Not sim remove Generated branch&quot;);</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">//   ContinueLineAfter(&quot;   else THSFinalState::SetGenParts(&amp;Generated);&quot;);</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  TString branch=FindNextLineLike(<span class="stringliteral">&quot;fChain-&gt;SetBranchAddress(\&quot;Particles\&quot;&quot;</span>);    </div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot; THSFinalState::SetDetParts(Particles);&quot;</span>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  branch=FindNextLineLike(<span class="stringliteral">&quot;fChain-&gt;SetBranchAddress(\&quot;Generated\&quot;&quot;</span>);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">if</span>(branch.Contains(<span class="stringliteral">&quot;Generated&quot;</span>)){</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot; if(fChain-&gt;GetBranch(\&quot;Generated\&quot;))THSFinalState::SetGenParts(Generated);&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  fCurMacro.SaveSource(fSelName+<span class="stringliteral">&quot;.h&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span>  <span class="comment">//Now with Control</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  fCurMacro=TMacro(TString(<span class="stringliteral">&quot;Control_&quot;</span>)+fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;HSout(&quot;</span>,<span class="stringliteral">&quot;  HSMacPath(\&quot;ADDITIONALMACROPATH_WHEREPROJECTIS\&quot;);&quot;</span>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  HSfinal(\&quot;&quot;</span>+fFinalName+<span class="stringliteral">&quot;\&quot;);&quot;</span>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  fCurMacro.SaveSource(TString(<span class="stringliteral">&quot;Control_&quot;</span>)+fSelName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;}</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">// void THSSkeleton::HSHisto(){</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//   fPlace=0;</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">//   //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">//   //First deal with .C</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">//   fCurMacro=TMacro(fSelName+&quot;.C&quot;);</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">//   fCurMacro.SaveSource(fSelName+&quot;.C&quot;);</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">//   //////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">//   //Now with .h</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">//   fCurMacro=TMacro(fSelName+&quot;.h&quot;);</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">//   fCurMacro.SaveSource(fSelName+&quot;.h&quot;);</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#af67f1b774918fd0e3aa348eb5b493bf8">  436</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#af67f1b774918fd0e3aa348eb5b493bf8">THSSkeleton::CreateRooFitEventsPDF</a>(TString pdfName,TString obsNames,TString parNames){</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  TObjArray* obss=obsNames.Tokenize(<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  TObjArray* pars=parNames.Tokenize(<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">//Check for categories</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  vector&lt;Bool_t&gt; is_cat;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span>(TString(obss-&gt;At(io)-&gt;GetName()).Contains(<span class="stringliteral">&quot;CAT:&quot;</span>)){</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      TString newstr=obss-&gt;At(io)-&gt;GetName();</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      is_cat.push_back(kTRUE);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      newstr.ReplaceAll(<span class="stringliteral">&quot;CAT:&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>TObjString*<span class="keyword">&gt;</span>(obss-&gt;At(io))-&gt;SetString(newstr); <span class="comment">//Get rid of CAT:</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      obsNames.ReplaceAll(TString(<span class="stringliteral">&quot;CAT:&quot;</span>)+newstr,newstr);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">else</span> is_cat.push_back(kFALSE);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  TString varNames=obsNames+<span class="stringliteral">&quot;,&quot;</span>+parNames;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">//Make standard RooFit Pdf</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  RooClassFactory::makePdf(pdfName,varNames) ;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">//Open code to add RooHSEventsPDF parts</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  fCurMacro=TMacro(pdfName+<span class="stringliteral">&quot;.cxx&quot;</span>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;RooAbsPdf(name,title)&quot;</span>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  ((TObjString*)fCurMacro.GetListOfLines()-&gt;At(fPlace))-&gt;SetString(<span class="stringliteral">&quot;   RooHSEventsPDF(name,title),&quot;</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;RooAbsPdf(other,name)&quot;</span>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  ((TObjString*)fCurMacro.GetListOfLines()-&gt;At(fPlace))-&gt;SetString(<span class="stringliteral">&quot;   RooHSEventsPDF(other,name),&quot;</span>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">//Now add observables to ProxSet</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;{&quot;</span>,<span class="stringliteral">&quot;   MakeSets();&quot;</span>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">//Edit text</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;   &quot;</span>)+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;.SetName(_&quot;</span>+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;.GetName());&quot;</span>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">for</span>(Int_t ip=0;ip&lt;pars-&gt;GetEntries();ip++)</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;   &quot;</span>)+pars-&gt;At(ip)-&gt;GetName()+<span class="stringliteral">&quot;.SetName(_&quot;</span>+pars-&gt;At(ip)-&gt;GetName()+<span class="stringliteral">&quot;.GetName());&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;{&quot;</span>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   MakeSets();&quot;</span>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;   &quot;</span>)+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;.SetName(other.&quot;</span>+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;.GetName());&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">for</span>(Int_t ip=0;ip&lt;pars-&gt;GetEntries();ip++)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;   &quot;</span>)+pars-&gt;At(ip)-&gt;GetName()+<span class="stringliteral">&quot;.SetName(other.&quot;</span>+pars-&gt;At(ip)-&gt;GetName()+<span class="stringliteral">&quot;.GetName());&quot;</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   if(fEvTree) SetEvTree(fEvTree);//Needs fProxSet filled first&quot;</span>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">//Make make sets function need to iterate over obsNames and parNames</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;void &quot;</span>+pdfName+<span class="stringliteral">&quot;::MakeSets(){&quot;</span>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span>(!is_cat[io])ContinueLineAfter(TString(<span class="stringliteral">&quot;   fProxSet.push_back(&amp;&quot;</span>)+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;);&quot;</span>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">else</span> ContinueLineAfter(TString(<span class="stringliteral">&quot;   fCatSet.push_back(&amp;&quot;</span>)+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;);&quot;</span>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">for</span>(Int_t ip=0;ip&lt;pars-&gt;GetEntries();ip++)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    ContinueLineAfter(TString(<span class="stringliteral">&quot;   fParSet.push_back(&amp;&quot;</span>)+pars-&gt;At(ip)-&gt;GetName()+<span class="stringliteral">&quot;);&quot;</span>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// ContinueLineAfter(&quot;   fVarSet.push_back(RooArgList(\&quot;AllVars\&quot;));&quot;);</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   InitSets();&quot;</span>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">//Now evaluateMC template</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  MoveToLine(<span class="stringliteral">&quot;evaluate()&quot;</span>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;Double_t &quot;</span>+pdfName+<span class="stringliteral">&quot;::evaluateMC() const {&quot;</span>,1);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;// ENTER IDENTICAL EXPRESSION TO evaluate() IN TERMS OF MC VARIABLE ARGUMENTS HERE&quot;</span>);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  Int_t nv=0;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  Int_t nc=0;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span>(!is_cat[io]) ContinueLineAfter(TString(<span class="stringliteral">&quot;  Double_t mc&quot;</span>)+obss-&gt;At(io)-&gt;GetName()+Form(<span class="stringliteral">&quot;=fMCVar[%d];&quot;</span>,nv++));</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">else</span> ContinueLineAfter(TString(<span class="stringliteral">&quot;  Int_t mc&quot;</span>)+obss-&gt;At(io)-&gt;GetName()+Form(<span class="stringliteral">&quot;=fMCCat[%d];&quot;</span>,nc++));</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;   return 1.0;&quot;</span>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// ContinueLineAfter(TString(&quot;Int_t &quot;)+pdfName+&quot;::getAnalyticalIntegral(RooArgSet&amp; allVars, RooArgSet&amp; analVars,const char* rangeName) const&quot;);</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// ContinueLineAfter(&quot;{ //return 0; //might be good to check numerical integral sometimes&quot;);</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// ContinueLineAfter(&quot;&quot;);</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">//  ContinueLineAfter(&quot;&quot;);</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// ContinueLineAfter(&quot;&quot;);</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  </div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">//Done .C file</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">//fix categories</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span>(is_cat[io]){</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      fPlace=0;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      FindNextLineLike(obss-&gt;At(io)-&gt;GetName());</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      ReplaceInCurrLine(<span class="stringliteral">&quot;RooAbsReal&quot;</span>,<span class="stringliteral">&quot;RooAbsCategory&quot;</span>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  fPlace=0;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  fCurMacro.SaveSource(pdfName+<span class="stringliteral">&quot;.cxx&quot;</span>);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">  ////////////////////////////////////////////////////////////////////  </span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span>  <span class="comment">//Now with .h</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  fCurMacro=TMacro(pdfName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;RooAbsPdf.h&quot;</span>,<span class="stringliteral">&quot;#include \&quot;RooHSEventsPDF.h\&quot;&quot;</span>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  ReplaceMacroText(<span class="stringliteral">&quot;public RooAbsPdf&quot;</span>,<span class="stringliteral">&quot;public RooHSEventsPDF&quot;</span>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">//fix categories</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span>(is_cat[io]){</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      fPlace=0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      FindNextLineLike(obss-&gt;At(io)-&gt;GetName());</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      ReplaceInCurrLine(<span class="stringliteral">&quot;RooAbsReal&quot;</span>,<span class="stringliteral">&quot;RooAbsCategory&quot;</span>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      fPlace++;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      FindNextLineLike(obss-&gt;At(io)-&gt;GetName());</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      ReplaceInCurrLine(<span class="stringliteral">&quot;RooRealProxy&quot;</span>,<span class="stringliteral">&quot;RooCategoryProxy&quot;</span>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  fPlace=0;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">if</span>(!is_cat[0]) AddLineAfter(<span class="stringliteral">&quot;protected&quot;</span>,TString(<span class="stringliteral">&quot;  Double_t fMC&quot;</span>)+obss-&gt;At(0)-&gt;GetName()+<span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">else</span> AddLineAfter(<span class="stringliteral">&quot;protected&quot;</span>,TString(<span class="stringliteral">&quot;  Int_t fMC&quot;</span>)+obss-&gt;At(0)-&gt;GetName()+<span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">for</span>(Int_t io=1;io&lt;obss-&gt;GetEntries();io++)</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span>(!is_cat[io]) ContinueLineAfter(TString(<span class="stringliteral">&quot;  Double_t fMC&quot;</span>)+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">else</span>  ContinueLineAfter(TString(<span class="stringliteral">&quot;  Int_t fMC&quot;</span>)+obss-&gt;At(io)-&gt;GetName()+<span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  AddLineAfter(<span class="stringliteral">&quot;Double_t evaluate()&quot;</span>,<span class="stringliteral">&quot;  Double_t evaluateMC() const ;&quot;</span>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// AddLineAfter(&quot;inline virtual ~&quot;,&quot;  virtual Int_t getAnalyticalIntegral(RooArgSet&amp; allVars, RooArgSet&amp; analVars,const char* rangeName) const;&quot;);</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  ContinueLineAfter(<span class="stringliteral">&quot;  void MakeSets();&quot;</span>);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  fCurMacro.SaveSource(pdfName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">////////////////////////////////////////////////////</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">/// Create a FinalState project. \n</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">/// Set fFinalTopo with SetFinalStateTopo() \n</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">/// Set fFinalParts with SetFinalStateParts() \n</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">/// Set fFinalName with SetFinalState() \n</span></div><div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a86194778a18af4b5f79abf3f19cef02f">  563</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a86194778a18af4b5f79abf3f19cef02f">THSSkeleton::CreateMyFinalState</a>(){</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  TObjArray* topos=0;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span>(fFinalTopo==TString(<span class="stringliteral">&quot;&quot;</span>))cout&lt;&lt;<span class="stringliteral">&quot;Warning No finalstate topologies set, you will have to edit the files yourself&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    topos=fFinalTopo.Tokenize(<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  TObjArray* finals=0;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">if</span>(fFinalParts==TString(<span class="stringliteral">&quot;&quot;</span>))cout&lt;&lt;<span class="stringliteral">&quot;Warning No finalstate final state set, you will have to edit the files yourself&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    finals=fFinalParts.Tokenize(<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  TString HSANA=gSystem-&gt;Getenv(<span class="stringliteral">&quot;HSANA&quot;</span>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  gSystem-&gt;Exec(Form(<span class="stringliteral">&quot;cp %s/THSFinalTemp.h THS%s.h&quot;</span>,HSANA.Data(),fFinalName.Data()));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">//gSystem-&gt;Exec(Form(&quot;cp %s/THSFinalTemp.h THS%s.h&quot;,&quot;.&quot;,fFinalName.Data()));</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  fCurMacro=TMacro(TString(<span class="stringliteral">&quot;THS&quot;</span>)+fFinalName+<span class="stringliteral">&quot;.h&quot;</span>);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  ReplaceAllMacroText(<span class="stringliteral">&quot;FinalTemp&quot;</span>,fFinalName);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  TString UpperFinalName=fFinalName;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  UpperFinalName.ToUpper();</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  ReplaceAllMacroText(<span class="stringliteral">&quot;PROJTEMP&quot;</span>,UpperFinalName);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Topology flags for this&quot;</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++)</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;  Int_t fTID_%d=-1;&quot;</span>,io));</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  fPlace=0;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Init functions&quot;</span>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;  void Init_Iter%d();&quot;</span>,io));</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++)</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;  void Topo_%d();&quot;</span>,io));</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  fPlace=0;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Final Particles&quot;</span>);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;finals-&gt;GetEntries();io++){</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    TString sparticle=finals-&gt;At(io)-&gt;GetName();</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;  THSParticle f%s=THSParticle(\&quot;%s\&quot;);&quot;</span>,TString(sparticle(0,sparticle.First(<span class="stringliteral">&quot;:&quot;</span>))).Data(),TString(sparticle(sparticle.First(<span class="stringliteral">&quot;:&quot;</span>)+1,sparticle.Sizeof())).Data()));</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  fCurMacro.SaveSource(TString(<span class="stringliteral">&quot;THS&quot;</span>)+fFinalName+<span class="stringliteral">&quot;.h&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"></span>  </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  gSystem-&gt;Exec(Form(<span class="stringliteral">&quot;cp %s/THSFinalTemp.C THS%s.C&quot;</span>,HSANA.Data(),fFinalName.Data()));</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  fCurMacro=TMacro(TString(<span class="stringliteral">&quot;THS&quot;</span>)+fFinalName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  fPlace=0;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  ReplaceAllMacroText(<span class="stringliteral">&quot;FinalTemp&quot;</span>,fFinalName);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  fPlace=0;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//include topology for analysis&quot;</span>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;  fTID_%d=AddTopology(\&quot;%s\&quot;);&quot;</span>,io,topos-&gt;At(io)-&gt;GetName()));</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  fPlace=0;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Do they correspond to a defined topology?&quot;</span>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;    else if(fCurrTopo==fTID_%d) Topo_%d();&quot;</span>,io,io));</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  fPlace=0;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Define topology Iterator functions&quot;</span>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++){</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;void THS%s::Init_Iter%d(){&quot;</span>,fFinalName.Data(),io));</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;  //THSParticle iterator initialisation&quot;</span>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;//If create iterator must configure it&quot;</span>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;  //fDetIter[FTID_0]-&gt;ConfigureIters();&quot;</span>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  fPlace=0;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Define topology functions&quot;</span>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++){</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;void THS%s::Topo_%d(){&quot;</span>,fFinalName.Data(),io));</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;  //Reconstruct missing or combined particles&quot;</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    ContinueLineAfter(<span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  fPlace=0;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Set final state&quot;</span>);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;finals-&gt;GetEntries();io++){</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    TString sparticle=finals-&gt;At(io)-&gt;GetName();</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;  fFinal.push_back(&amp;f%s);&quot;</span>,TString(sparticle(0,sparticle.First(<span class="stringliteral">&quot;:&quot;</span>))).Data()));</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  fPlace=0;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  FindNextLineLike(<span class="stringliteral">&quot;//Initialise particle iters&quot;</span>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">for</span>(Int_t io=0;io&lt;topos-&gt;GetEntries();io++)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    ContinueLineAfter(Form(<span class="stringliteral">&quot;  Init_Iter%d();&quot;</span>,io));</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  fCurMacro.SaveSource(TString(<span class="stringliteral">&quot;THS&quot;</span>)+fFinalName+<span class="stringliteral">&quot;.C&quot;</span>);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">//////////////////////////////////////////////////////</span></div><div class="line"><a name="l00655"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a53ff720886a935ed4c64b677db581fdc">  655</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a53ff720886a935ed4c64b677db581fdc">THSSkeleton::AddLineAfter</a>(TString line0,TString line1,Int_t off){</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  TList *lines=fCurMacro.GetListOfLines();</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  MoveToLine(line0);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  fPlace=fPlace+1+off;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  lines-&gt;AddAt(<span class="keyword">new</span> TObjString(line1),fPlace);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#ad7e8114cb89a560bf9ebccafceb54da5">  662</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#ad7e8114cb89a560bf9ebccafceb54da5">THSSkeleton::ContinueLineAfter</a>(TString line1,Int_t off){</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  TList *lines=fCurMacro.GetListOfLines();</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  fPlace=fPlace+1+off;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  lines-&gt;AddAt(<span class="keyword">new</span> TObjString(line1),fPlace);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a004123bea78a79912e1f5cdb8d94354b">  668</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a004123bea78a79912e1f5cdb8d94354b">THSSkeleton::MoveToLine</a>(TString line0){</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  TList *lines=fCurMacro.GetListOfLines();</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  TObject* obj=fCurMacro.GetLineWith(line0);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">if</span>(!obj) Error(<span class="stringliteral">&quot;THSSkeleton::MoveToLine&quot;</span>,<span class="stringliteral">&quot;Line %s does not exist in %s&quot;</span>,line0.Data(),<span class="stringliteral">&quot;file&quot;</span>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  fPlace=lines-&gt;IndexOf(obj); <span class="comment">//get line number</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;}</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#af854c5549ebf37330c3018ab7e313640">  675</a></span>&#160;TString <a class="code" href="classTHSSkeleton.html#af854c5549ebf37330c3018ab7e313640">THSSkeleton::FindNextLineLike</a>(TString linelike){</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  TList *lines=fCurMacro.GetListOfLines();</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  TObjString* thisline=0;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  Int_t count=0;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">for</span>(count=fPlace;count&lt;lines-&gt;GetEntries();count++){</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    thisline=<span class="keyword">dynamic_cast&lt;</span>TObjString*<span class="keyword">&gt;</span>(lines-&gt;At(count));</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span>(thisline-&gt;String().Contains(linelike))</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">if</span>(count==lines-&gt;GetEntries()) {fPlace=count; <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;} <span class="comment">//didn&#39;t find line go to end</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">else</span> fPlace=count; <span class="comment">//get line number</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">return</span> thisline-&gt;String();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a81d8fcb511a49a32ecc756752bdf885d">  689</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a81d8fcb511a49a32ecc756752bdf885d">THSSkeleton::ReplaceInCurrLine</a>(TString text0,TString text1){</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// TString strline=fCurMacro.GetLineWith(text0)-&gt;GetString();</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  TList *lines=fCurMacro.GetListOfLines();</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  TObjString*  thisline=<span class="keyword">dynamic_cast&lt;</span>TObjString*<span class="keyword">&gt;</span>(lines-&gt;At(fPlace));</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span>(!thisline-&gt;String().Contains(text0)) cout&lt;&lt;<span class="stringliteral">&quot;Warning : ReplaceInCurrLine text not found &quot;</span>&lt;&lt;text0&lt;&lt;<span class="stringliteral">&quot; in line &quot;</span>&lt;&lt;thisline-&gt;String()&lt;&lt;endl;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  thisline-&gt;String().ReplaceAll(text0,text1);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;}</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a6833b1d1bb560193f95ca5679c06806d">  697</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a6833b1d1bb560193f95ca5679c06806d">THSSkeleton::ReplaceMacroText</a>(TString text0,TString text1){</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  TString strline=fCurMacro.GetLineWith(text0)-&gt;GetString();</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  strline.ReplaceAll(text0,text1);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  fCurMacro.GetLineWith(text0)-&gt;SetString(strline);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="classTHSSkeleton.html#a75aa6472ed2a3936249f09821b70faea">  703</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSSkeleton.html#a75aa6472ed2a3936249f09821b70faea">THSSkeleton::ReplaceAllMacroText</a>(TString text0,TString text1){</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  TList *lines=fCurMacro.GetListOfLines();</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  TObjString* thisline=0;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  Int_t count=0;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">for</span>(count=fPlace;count&lt;lines-&gt;GetEntries();count++){</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    thisline=<span class="keyword">dynamic_cast&lt;</span>TObjString*<span class="keyword">&gt;</span>(lines-&gt;At(count));</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span>(thisline-&gt;String().Contains(text0))</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      thisline-&gt;SetString(thisline-&gt;String().ReplaceAll(text0,text1));</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;}</div><div class="ttc" id="classTHSSkeleton_html_a3c8d74447096c00b4a78796d44d996b9"><div class="ttname"><a href="classTHSSkeleton.html#a3c8d74447096c00b4a78796d44d996b9">THSSkeleton::CreateSelector</a></div><div class="ttdeci">void CreateSelector(TString selname, TString filename, TString treename, TString opt=&quot;&quot;)</div><div class="ttdoc">Create intial selector code from TTree::MakeSelector() </div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00020">THSSkeleton.C:20</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_af27bb23d70a6f6672066fa8290f65643"><div class="ttname"><a href="classTHSSkeleton.html#af27bb23d70a6f6672066fa8290f65643">THSSkeleton::HSOut_C</a></div><div class="ttdeci">void HSOut_C()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00069">THSSkeleton.C:69</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_af67f1b774918fd0e3aa348eb5b493bf8"><div class="ttname"><a href="classTHSSkeleton.html#af67f1b774918fd0e3aa348eb5b493bf8">THSSkeleton::CreateRooFitEventsPDF</a></div><div class="ttdeci">void CreateRooFitEventsPDF(TString pdfName, TString obsNames, TString parNames)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00436">THSSkeleton.C:436</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a004123bea78a79912e1f5cdb8d94354b"><div class="ttname"><a href="classTHSSkeleton.html#a004123bea78a79912e1f5cdb8d94354b">THSSkeleton::MoveToLine</a></div><div class="ttdeci">void MoveToLine(TString line0)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00668">THSSkeleton.C:668</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a75aa6472ed2a3936249f09821b70faea"><div class="ttname"><a href="classTHSSkeleton.html#a75aa6472ed2a3936249f09821b70faea">THSSkeleton::ReplaceAllMacroText</a></div><div class="ttdeci">void ReplaceAllMacroText(TString text0, TString text1)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00703">THSSkeleton.C:703</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a0c5f959f20a777e42fe683ce1b62142b"><div class="ttname"><a href="classTHSSkeleton.html#a0c5f959f20a777e42fe683ce1b62142b">THSSkeleton::HSNewTree</a></div><div class="ttdeci">void HSNewTree()</div><div class="ttdoc">Adds example of how to create a new output tree. </div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00229">THSSkeleton.C:229</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a46b824d511a6c8650f2cd4e9ec1c893e"><div class="ttname"><a href="classTHSSkeleton.html#a46b824d511a6c8650f2cd4e9ec1c893e">THSSkeleton::HSWeights</a></div><div class="ttdeci">void HSWeights()</div><div class="ttdoc">Adds example of how to use the THSWeights class. </div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00269">THSSkeleton.C:269</a></div></div>
<div class="ttc" id="THSSkeleton_8h_html"><div class="ttname"><a href="THSSkeleton_8h.html">THSSkeleton.h</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a2dca73eeb476f503d006aa033c263437"><div class="ttname"><a href="classTHSSkeleton.html#a2dca73eeb476f503d006aa033c263437">THSSkeleton::AddHSOutput</a></div><div class="ttdeci">void AddHSOutput()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00047">THSSkeleton.C:47</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_af854c5549ebf37330c3018ab7e313640"><div class="ttname"><a href="classTHSSkeleton.html#af854c5549ebf37330c3018ab7e313640">THSSkeleton::FindNextLineLike</a></div><div class="ttdeci">TString FindNextLineLike(TString linelike)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00675">THSSkeleton.C:675</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a86194778a18af4b5f79abf3f19cef02f"><div class="ttname"><a href="classTHSSkeleton.html#a86194778a18af4b5f79abf3f19cef02f">THSSkeleton::CreateMyFinalState</a></div><div class="ttdeci">void CreateMyFinalState()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00563">THSSkeleton.C:563</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a53ff720886a935ed4c64b677db581fdc"><div class="ttname"><a href="classTHSSkeleton.html#a53ff720886a935ed4c64b677db581fdc">THSSkeleton::AddLineAfter</a></div><div class="ttdeci">void AddLineAfter(TString line0, TString line1, Int_t off=0)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00655">THSSkeleton.C:655</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a6833b1d1bb560193f95ca5679c06806d"><div class="ttname"><a href="classTHSSkeleton.html#a6833b1d1bb560193f95ca5679c06806d">THSSkeleton::ReplaceMacroText</a></div><div class="ttdeci">void ReplaceMacroText(TString text0, TString text1)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00697">THSSkeleton.C:697</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a24352664eaa32dba6b83886659abc2bd"><div class="ttname"><a href="classTHSSkeleton.html#a24352664eaa32dba6b83886659abc2bd">THSSkeleton::HSOut_h</a></div><div class="ttdeci">void HSOut_h()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00105">THSSkeleton.C:105</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_acddda64b12f713fc81445f44fdfe5d07"><div class="ttname"><a href="classTHSSkeleton.html#acddda64b12f713fc81445f44fdfe5d07">THSSkeleton::HSHisto</a></div><div class="ttdeci">void HSHisto()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00137">THSSkeleton.C:137</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_afc6babad73c297fe9e0cb808226525b9"><div class="ttname"><a href="classTHSSkeleton.html#afc6babad73c297fe9e0cb808226525b9">THSSkeleton::HSLPS</a></div><div class="ttdeci">void HSLPS()</div><div class="ttdoc">Adds example of how to use the THSLongPS class. </div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00323">THSSkeleton.C:323</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_af2297529dd6e2c45ce5d569173611416"><div class="ttname"><a href="classTHSSkeleton.html#af2297529dd6e2c45ce5d569173611416">THSSkeleton::HSAppend</a></div><div class="ttdeci">void HSAppend()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00196">THSSkeleton.C:196</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a4d307de89e4fcbf665c6809dace1793f"><div class="ttname"><a href="classTHSSkeleton.html#a4d307de89e4fcbf665c6809dace1793f">THSSkeleton::HSOut_Control</a></div><div class="ttdeci">void HSOut_Control()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00119">THSSkeleton.C:119</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_aa6586db59b377db06e046fca5af294ee"><div class="ttname"><a href="classTHSSkeleton.html#aa6586db59b377db06e046fca5af294ee">THSSkeleton::HSFinalState</a></div><div class="ttdeci">void HSFinalState()</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00359">THSSkeleton.C:359</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_a81d8fcb511a49a32ecc756752bdf885d"><div class="ttname"><a href="classTHSSkeleton.html#a81d8fcb511a49a32ecc756752bdf885d">THSSkeleton::ReplaceInCurrLine</a></div><div class="ttdeci">void ReplaceInCurrLine(TString text0, TString text1)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00689">THSSkeleton.C:689</a></div></div>
<div class="ttc" id="classTHSSkeleton_html_ad7e8114cb89a560bf9ebccafceb54da5"><div class="ttname"><a href="classTHSSkeleton.html#ad7e8114cb89a560bf9ebccafceb54da5">THSSkeleton::ContinueLineAfter</a></div><div class="ttdeci">void ContinueLineAfter(TString line1, Int_t off=0)</div><div class="ttdef"><b>Definition:</b> <a href="THSSkeleton_8C_source.html#l00662">THSSkeleton.C:662</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 10 2017 13:45:58 for HASPECT6 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
