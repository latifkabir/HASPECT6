<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HASPECT6: HaSpect/THSParticle.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HASPECT6
   </div>
   <div id="projectbrief">Hadron spectroscopy data analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3ca80ef9e5877ea9d11d1a324ddaa5cd.html">HaSpect</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">THSParticle.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="THSParticle_8C.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//--Author      DI Glazier 30/06/2014</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//--Rev</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//--Update</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//--Description</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//HASPECT Event Reconstruction</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//THSParticle</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//Persistant Data structure</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//Contains reconstructed information required for data analysis</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="THSParticle_8h.html">THSParticle.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<a class="code" href="THSParticle_8C.html#a244bae174c170ce22ff1bf918b39cbd2">ClassImp</a>(<a class="code" href="classTHSParticle.html">THSParticle</a>);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="classTHSParticle.html#a3b8be65d9717d601277a7aa136706c0e">   15</a></span>&#160;<a class="code" href="classTHSParticle.html#a3b8be65d9717d601277a7aa136706c0e">THSParticle::THSParticle</a>() : fP4(), fVertex(), fPDGCode(0), fPDGMass(0), fMeasMass(0) {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="classTHSParticle.html#a7ef54de899649a51d55ef77382293e1c">   17</a></span>&#160;<a class="code" href="classTHSParticle.html#a3b8be65d9717d601277a7aa136706c0e">THSParticle::THSParticle</a>(<span class="keywordtype">int</span> code) : <a class="code" href="classTHSParticle.html#a2c7e128e841d62fb86ee02ad1f4f4515">fP4</a>(), <a class="code" href="classTHSParticle.html#a30b434a742e3c8b06e44ecf487f3ffd2">fVertex</a>(), <a class="code" href="classTHSParticle.html#a12d2b1aaef1e4ef1e4d4f54411cd2114">fPDGCode</a>(0), <a class="code" href="classTHSParticle.html#a5f2a06b080f8b3d1b0f2d71bb87d9860">fPDGMass</a>(0), <a class="code" href="classTHSParticle.html#ac31d8e2d6a7160b359f45de8a5184c4d">fMeasMass</a>(0) {</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <a class="code" href="classTHSParticle.html#aa1c8c77b1ac1d266e0c1664c3f8505b2">SetPDGcode</a>(code);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classTHSParticle.html#a42742bc02dbf072d6903788fb4e4e21a">   20</a></span>&#160;<a class="code" href="classTHSParticle.html#a3b8be65d9717d601277a7aa136706c0e">THSParticle::THSParticle</a>(TString pdgname) : <a class="code" href="classTHSParticle.html#a2c7e128e841d62fb86ee02ad1f4f4515">fP4</a>(), <a class="code" href="classTHSParticle.html#a30b434a742e3c8b06e44ecf487f3ffd2">fVertex</a>(), <a class="code" href="classTHSParticle.html#a12d2b1aaef1e4ef1e4d4f54411cd2114">fPDGCode</a>(0), <a class="code" href="classTHSParticle.html#a5f2a06b080f8b3d1b0f2d71bb87d9860">fPDGMass</a>(0), <a class="code" href="classTHSParticle.html#ac31d8e2d6a7160b359f45de8a5184c4d">fMeasMass</a>(0) {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="classTHSParticle.html#aa1c8c77b1ac1d266e0c1664c3f8505b2">SetPDGcode</a>(TDatabasePDG::Instance()-&gt;GetParticle(pdgname)-&gt;PdgCode());</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="classTHSParticle.html#ab5787399b116e743b636da09c2a35133">   23</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSParticle.html#ab5787399b116e743b636da09c2a35133">THSParticle::Print</a>(Option_t *)<span class="keyword"> const</span>{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;Printing THSParticle of type &quot;</span>&lt;&lt;TDatabasePDG::Instance()-&gt;GetParticle(<a class="code" href="classTHSParticle.html#a12d2b1aaef1e4ef1e4d4f54411cd2114">fPDGCode</a>)-&gt;GetName()&lt;&lt;endl;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="classTHSParticle.html#a2c7e128e841d62fb86ee02ad1f4f4515">fP4</a>.Print(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="classTHSParticle.html#a30b434a742e3c8b06e44ecf487f3ffd2">fVertex</a>.Print(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="classTHSParticle.html#a9957a957f2da90fd258ff4c46bb8b0af">   29</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSParticle.html#a9957a957f2da90fd258ff4c46bb8b0af">THSParticle::CopyParticle</a>(<a class="code" href="classTHSParticle.html">THSParticle</a>* part,Bool_t andPDG){</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="classTHSParticle.html#ad18118c1274efe9f12a478bf5e9f5518">SetP4</a>(part-&gt;<a class="code" href="classTHSParticle.html#a194b598c47ae8706d15d71d70e8862bf">P4</a>());</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="classTHSParticle.html#a84d836fb5d7950c0481dea17137ed68b">SetVertex</a>(part-&gt;<a class="code" href="classTHSParticle.html#ac947f59e0cc2652aadd13b59bf7b3c9b">Vertex</a>());</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="classTHSParticle.html#a98d3c77467bf58ca8ba47f3abb8349c5">SetTime</a>(part-&gt;<a class="code" href="classTHSParticle.html#aeff0b0b0c83d7fe6914d6103e2dcfbcc">Time</a>());</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="classTHSParticle.html#a56290ceb0325ec93e77236b59148af07">SetMeasMass</a>(part-&gt;<a class="code" href="classTHSParticle.html#a724d73dac9366f4348186846d21e6d75">MeasMass</a>());</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">if</span>(andPDG) <a class="code" href="classTHSParticle.html#aa1c8c77b1ac1d266e0c1664c3f8505b2">SetPDGcode</a>(part-&gt;<a class="code" href="classTHSParticle.html#a164aa6843ee33558e8c8f1600a50ed96">PDG</a>());</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="classTHSParticle.html#a50601b18bfa16c53d23ce84c4cfc1ccd">SetDoca</a>(part-&gt;<a class="code" href="classTHSParticle.html#a65c1e9ae53d1e611002ea8a501928b3a">Doca</a>());</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="classTHSParticle.html#a5d9e3be0f990518dd7435a8c2d70095c">SetPath</a>(part-&gt;<a class="code" href="classTHSParticle.html#aab4b3a7a1171b5703dc74490b91203f0">Path</a>());</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classTHSParticle.html#aa5a3c93b2752c427646ed98ce158ed33">SetEdep</a>(part-&gt;<a class="code" href="classTHSParticle.html#ab19db37973f622a19debdbfefb6606e8">Edep</a>());</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classTHSParticle.html#abe7533f39cbcceaa64105227ada94a49">SetDetector</a>(part-&gt;<a class="code" href="classTHSParticle.html#af88e87db067c5185a298429ac5cd5e51">Detector</a>());</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classTHSParticle.html#a297a389a45e1fc05f5cf0b222d75956e">   40</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSParticle.html#a297a389a45e1fc05f5cf0b222d75956e">THSParticle::Add</a>(<a class="code" href="classTHSParticle.html">THSParticle</a>* hsp1, <a class="code" href="classTHSParticle.html">THSParticle</a>* hsp2,Int_t pdg){</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">//  SetVertex(hsp1-&gt;Vertex()+hsp2-&gt;Vertex()); //average vertex</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classTHSParticle.html#ad18118c1274efe9f12a478bf5e9f5518">SetP4</a>(hsp1-&gt;<a class="code" href="classTHSParticle.html#a194b598c47ae8706d15d71d70e8862bf">P4</a>()+hsp2-&gt;<a class="code" href="classTHSParticle.html#a194b598c47ae8706d15d71d70e8862bf">P4</a>());</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classTHSParticle.html#a98d3c77467bf58ca8ba47f3abb8349c5">SetTime</a>((hsp1-&gt;<a class="code" href="classTHSParticle.html#aeff0b0b0c83d7fe6914d6103e2dcfbcc">Time</a>()+hsp2-&gt;<a class="code" href="classTHSParticle.html#aeff0b0b0c83d7fe6914d6103e2dcfbcc">Time</a>())/2);<span class="comment">//average time</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classTHSParticle.html#aa1c8c77b1ac1d266e0c1664c3f8505b2">SetPDGcode</a>(pdg);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span>(pdg){</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classTHSParticle.html#a56290ceb0325ec93e77236b59148af07">SetMeasMass</a>(<a class="code" href="classTHSParticle.html#a2c7e128e841d62fb86ee02ad1f4f4515">fP4</a>.M());</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classTHSParticle.html#a9c960fa31bec73fbb51754d7dc3237e1">TakePDGMass</a>();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  TVector3 vertex;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  Double_t D=0;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="classTHSParticle.html#aea0685f0834feddcb79a787312b9302e">fDoca</a>=<a class="code" href="classTHSParticle.html#ab9aad1dcdd17916e70fbacd02f63e6da">Calc_dtfDOCA</a>(hsp1-&gt;<a class="code" href="classTHSParticle.html#ac947f59e0cc2652aadd13b59bf7b3c9b">Vertex</a>(),hsp1-&gt;<a class="code" href="classTHSParticle.html#a194b598c47ae8706d15d71d70e8862bf">P4</a>().Vect().Unit(),hsp2-&gt;<a class="code" href="classTHSParticle.html#ac947f59e0cc2652aadd13b59bf7b3c9b">Vertex</a>(),hsp2-&gt;<a class="code" href="classTHSParticle.html#a194b598c47ae8706d15d71d70e8862bf">P4</a>().Vect().Unit(),&amp;vertex);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classTHSParticle.html#a84d836fb5d7950c0481dea17137ed68b">SetVertex</a>(vertex);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">//Truth Particle</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span>(hsp1-&gt;<a class="code" href="classTHSParticle.html#ab7a3351d97014ef7c1f0ed4e505b02eb">TruthP4p</a>()-&gt;E()||hsp2-&gt;<a class="code" href="classTHSParticle.html#ab7a3351d97014ef7c1f0ed4e505b02eb">TruthP4p</a>()-&gt;E()){</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classTHSParticle.html#ab9aad1dcdd17916e70fbacd02f63e6da">Calc_dtfDOCA</a>(*hsp1-&gt;<a class="code" href="classTHSParticle.html#aa0c8643830ce0b97902d4c557b6a54e8">TruthVer</a>(),hsp1-&gt;<a class="code" href="classTHSParticle.html#ae149932e9e58be94bd230b217631d3a4">TruthP4</a>().Vect().Unit(),*hsp2-&gt;<a class="code" href="classTHSParticle.html#aa0c8643830ce0b97902d4c557b6a54e8">TruthVer</a>(),hsp2-&gt;<a class="code" href="classTHSParticle.html#ae149932e9e58be94bd230b217631d3a4">TruthP4</a>().Vect().Unit(),&amp;vertex);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classTHSParticle.html#a90dfafead616581d9dc218489f36c085">SetTruth</a>(*hsp1-&gt;<a class="code" href="classTHSParticle.html#ab7a3351d97014ef7c1f0ed4e505b02eb">TruthP4p</a>()+*hsp2-&gt;<a class="code" href="classTHSParticle.html#ab7a3351d97014ef7c1f0ed4e505b02eb">TruthP4p</a>(),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         vertex,pdg);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// if(pdg){</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//   SetMeasMass(fP4.M());</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">//   TakePDGMass();</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// }</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}   </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classTHSParticle.html#ab9aad1dcdd17916e70fbacd02f63e6da">   65</a></span>&#160;Double_t <a class="code" href="classTHSParticle.html#ab9aad1dcdd17916e70fbacd02f63e6da">THSParticle::Calc_dtfDOCA</a>( TVector3 locVertex1, TVector3 locUnitDir1, TVector3 locVertex2, TVector3 locUnitDir2, TVector3 *result){</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">//locVertex1= vertex position of track 1</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">//locUnitDir1 = unit veocity vector of track 1</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">//similar for 2 and result is calculated by this function</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">//Call function to calculate position of nearest approach for each track</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//take the average position as the resulting vertex</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">//take the difference in position as the DOCA</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  TVector3 locInterDOCA1;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  TVector3 locInterDOCA2; <span class="comment">//The positions for each track</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classTHSParticle.html#ac6d1585915c974ca136b2cbe3f2187b7">Calc_dtfInterDOCA</a>(locUnitDir1, locUnitDir2, locVertex1, locVertex2, &amp;locInterDOCA1, &amp;locInterDOCA2);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  *result=0.5*(locInterDOCA1+locInterDOCA2); <span class="comment">//the resulting vertex</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> (locInterDOCA1 - locInterDOCA2).Mag(); <span class="comment">//the DOCA</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classTHSParticle.html#ac6d1585915c974ca136b2cbe3f2187b7">   79</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTHSParticle.html#ac6d1585915c974ca136b2cbe3f2187b7">THSParticle::Calc_dtfInterDOCA</a>( TVector3 locUnitDir1, TVector3 locUnitDir2, TVector3 locVertex1,  TVector3 locVertex2, TVector3 *locInterDOCA1, TVector3 *locInterDOCA2){</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//originated from code by Jörn Langheinrich</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">//you can use this function to find the DOCA to a fixed point by calling this function with locUnitDir1 and 2 parallel, and the fixed vertex as locVertex2</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">double</span> locUnitDot = locUnitDir1*locUnitDir2;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">double</span> locDenominator = locUnitDot*locUnitDot - 1.0; <span class="comment">/// scalar product of directions</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> locDistVertToInterDOCA1 = 0.0, locDistVertToInterDOCA2 = 0.0; <span class="comment">//distance from vertex to DOCA point</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">if</span>(fabs(locDenominator) &lt; 1.0E-15) <span class="comment">//parallel</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    locDistVertToInterDOCA1 = (locVertex2 - locVertex1)*(locUnitDir2)/locUnitDot; <span class="comment">//the opposite</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">double</span> locA = (locVertex1 - locVertex2)*(locUnitDir1);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">double</span> locB = (locVertex1 - locVertex2)*(locUnitDir2);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    locDistVertToInterDOCA1 = (locA - locUnitDot*locB)/locDenominator;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    locDistVertToInterDOCA2 = (locUnitDot*locA - locB)/locDenominator;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  *locInterDOCA1 = locVertex1 + locDistVertToInterDOCA1*(locUnitDir1); <span class="comment">//intersection point between DOCA line and Kid 1</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  *locInterDOCA2 = locVertex2 + locDistVertToInterDOCA2*(locUnitDir2); <span class="comment">//intersection point between DOCA line and Kid 2</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="ttc" id="classTHSParticle_html_abe7533f39cbcceaa64105227ada94a49"><div class="ttname"><a href="classTHSParticle.html#abe7533f39cbcceaa64105227ada94a49">THSParticle::SetDetector</a></div><div class="ttdeci">void SetDetector(Int_t det)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00076">THSParticle.h:76</a></div></div>
<div class="ttc" id="classTHSParticle_html_ab9aad1dcdd17916e70fbacd02f63e6da"><div class="ttname"><a href="classTHSParticle.html#ab9aad1dcdd17916e70fbacd02f63e6da">THSParticle::Calc_dtfDOCA</a></div><div class="ttdeci">Double_t Calc_dtfDOCA(TVector3 locVertex1, TVector3 locUnitDir1, TVector3 locVertex2, TVector3 locUnitDir2, TVector3 *result)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8C_source.html#l00065">THSParticle.C:65</a></div></div>
<div class="ttc" id="classTHSParticle_html_a30b434a742e3c8b06e44ecf487f3ffd2"><div class="ttname"><a href="classTHSParticle.html#a30b434a742e3c8b06e44ecf487f3ffd2">THSParticle::fVertex</a></div><div class="ttdeci">TVector3 fVertex</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00025">THSParticle.h:25</a></div></div>
<div class="ttc" id="classTHSParticle_html_a5f2a06b080f8b3d1b0f2d71bb87d9860"><div class="ttname"><a href="classTHSParticle.html#a5f2a06b080f8b3d1b0f2d71bb87d9860">THSParticle::fPDGMass</a></div><div class="ttdeci">Float_t fPDGMass</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00033">THSParticle.h:33</a></div></div>
<div class="ttc" id="classTHSParticle_html_a9957a957f2da90fd258ff4c46bb8b0af"><div class="ttname"><a href="classTHSParticle.html#a9957a957f2da90fd258ff4c46bb8b0af">THSParticle::CopyParticle</a></div><div class="ttdeci">void CopyParticle(THSParticle *part, Bool_t andPDG)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8C_source.html#l00029">THSParticle.C:29</a></div></div>
<div class="ttc" id="classTHSParticle_html_ac6d1585915c974ca136b2cbe3f2187b7"><div class="ttname"><a href="classTHSParticle.html#ac6d1585915c974ca136b2cbe3f2187b7">THSParticle::Calc_dtfInterDOCA</a></div><div class="ttdeci">void Calc_dtfInterDOCA(TVector3 locUnitDir1, TVector3 locUnitDir2, TVector3 locVertex1, TVector3 locVertex2, TVector3 *locInterDOCA1, TVector3 *locInterDOCA2)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8C_source.html#l00079">THSParticle.C:79</a></div></div>
<div class="ttc" id="classTHSParticle_html_aeff0b0b0c83d7fe6914d6103e2dcfbcc"><div class="ttname"><a href="classTHSParticle.html#aeff0b0b0c83d7fe6914d6103e2dcfbcc">THSParticle::Time</a></div><div class="ttdeci">Double_t Time()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00093">THSParticle.h:93</a></div></div>
<div class="ttc" id="classTHSParticle_html_ad18118c1274efe9f12a478bf5e9f5518"><div class="ttname"><a href="classTHSParticle.html#ad18118c1274efe9f12a478bf5e9f5518">THSParticle::SetP4</a></div><div class="ttdeci">void SetP4(TLorentzVector v)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00063">THSParticle.h:63</a></div></div>
<div class="ttc" id="classTHSParticle_html_ab5787399b116e743b636da09c2a35133"><div class="ttname"><a href="classTHSParticle.html#ab5787399b116e743b636da09c2a35133">THSParticle::Print</a></div><div class="ttdeci">virtual void Print(Option_t *option=&quot;&quot;) const </div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8C_source.html#l00023">THSParticle.C:23</a></div></div>
<div class="ttc" id="classTHSParticle_html_aea0685f0834feddcb79a787312b9302e"><div class="ttname"><a href="classTHSParticle.html#aea0685f0834feddcb79a787312b9302e">THSParticle::fDoca</a></div><div class="ttdeci">Float_t fDoca</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00037">THSParticle.h:37</a></div></div>
<div class="ttc" id="classTHSParticle_html_a2c7e128e841d62fb86ee02ad1f4f4515"><div class="ttname"><a href="classTHSParticle.html#a2c7e128e841d62fb86ee02ad1f4f4515">THSParticle::fP4</a></div><div class="ttdeci">TLorentzVector fP4</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00024">THSParticle.h:24</a></div></div>
<div class="ttc" id="classTHSParticle_html_a56290ceb0325ec93e77236b59148af07"><div class="ttname"><a href="classTHSParticle.html#a56290ceb0325ec93e77236b59148af07">THSParticle::SetMeasMass</a></div><div class="ttdeci">void SetMeasMass(Double_t mass)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00077">THSParticle.h:77</a></div></div>
<div class="ttc" id="classTHSParticle_html_a12d2b1aaef1e4ef1e4d4f54411cd2114"><div class="ttname"><a href="classTHSParticle.html#a12d2b1aaef1e4ef1e4d4f54411cd2114">THSParticle::fPDGCode</a></div><div class="ttdeci">Int_t fPDGCode</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00026">THSParticle.h:26</a></div></div>
<div class="ttc" id="classTHSParticle_html_af88e87db067c5185a298429ac5cd5e51"><div class="ttname"><a href="classTHSParticle.html#af88e87db067c5185a298429ac5cd5e51">THSParticle::Detector</a></div><div class="ttdeci">Int_t Detector()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00103">THSParticle.h:103</a></div></div>
<div class="ttc" id="classTHSParticle_html_a90dfafead616581d9dc218489f36c085"><div class="ttname"><a href="classTHSParticle.html#a90dfafead616581d9dc218489f36c085">THSParticle::SetTruth</a></div><div class="ttdeci">void SetTruth(THSParticle *part)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00081">THSParticle.h:81</a></div></div>
<div class="ttc" id="classTHSParticle_html_a50601b18bfa16c53d23ce84c4cfc1ccd"><div class="ttname"><a href="classTHSParticle.html#a50601b18bfa16c53d23ce84c4cfc1ccd">THSParticle::SetDoca</a></div><div class="ttdeci">void SetDoca(Double_t doca)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00074">THSParticle.h:74</a></div></div>
<div class="ttc" id="classTHSParticle_html_a724d73dac9366f4348186846d21e6d75"><div class="ttname"><a href="classTHSParticle.html#a724d73dac9366f4348186846d21e6d75">THSParticle::MeasMass</a></div><div class="ttdeci">Double_t MeasMass()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00092">THSParticle.h:92</a></div></div>
<div class="ttc" id="classTHSParticle_html"><div class="ttname"><a href="classTHSParticle.html">THSParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00021">THSParticle.h:21</a></div></div>
<div class="ttc" id="classTHSParticle_html_aa1c8c77b1ac1d266e0c1664c3f8505b2"><div class="ttname"><a href="classTHSParticle.html#aa1c8c77b1ac1d266e0c1664c3f8505b2">THSParticle::SetPDGcode</a></div><div class="ttdeci">void SetPDGcode(Int_t code)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00058">THSParticle.h:58</a></div></div>
<div class="ttc" id="classTHSParticle_html_a194b598c47ae8706d15d71d70e8862bf"><div class="ttname"><a href="classTHSParticle.html#a194b598c47ae8706d15d71d70e8862bf">THSParticle::P4</a></div><div class="ttdeci">TLorentzVector P4()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00086">THSParticle.h:86</a></div></div>
<div class="ttc" id="classTHSParticle_html_ac947f59e0cc2652aadd13b59bf7b3c9b"><div class="ttname"><a href="classTHSParticle.html#ac947f59e0cc2652aadd13b59bf7b3c9b">THSParticle::Vertex</a></div><div class="ttdeci">TVector3 Vertex()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00088">THSParticle.h:88</a></div></div>
<div class="ttc" id="classTHSParticle_html_a9c960fa31bec73fbb51754d7dc3237e1"><div class="ttname"><a href="classTHSParticle.html#a9c960fa31bec73fbb51754d7dc3237e1">THSParticle::TakePDGMass</a></div><div class="ttdeci">void TakePDGMass()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00078">THSParticle.h:78</a></div></div>
<div class="ttc" id="classTHSParticle_html_ac31d8e2d6a7160b359f45de8a5184c4d"><div class="ttname"><a href="classTHSParticle.html#ac31d8e2d6a7160b359f45de8a5184c4d">THSParticle::fMeasMass</a></div><div class="ttdeci">Float_t fMeasMass</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00034">THSParticle.h:34</a></div></div>
<div class="ttc" id="classTHSParticle_html_a65c1e9ae53d1e611002ea8a501928b3a"><div class="ttname"><a href="classTHSParticle.html#a65c1e9ae53d1e611002ea8a501928b3a">THSParticle::Doca</a></div><div class="ttdeci">Double_t Doca()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00096">THSParticle.h:96</a></div></div>
<div class="ttc" id="classTHSParticle_html_ab7a3351d97014ef7c1f0ed4e505b02eb"><div class="ttname"><a href="classTHSParticle.html#ab7a3351d97014ef7c1f0ed4e505b02eb">THSParticle::TruthP4p</a></div><div class="ttdeci">TLorentzVector * TruthP4p()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00105">THSParticle.h:105</a></div></div>
<div class="ttc" id="classTHSParticle_html_a164aa6843ee33558e8c8f1600a50ed96"><div class="ttname"><a href="classTHSParticle.html#a164aa6843ee33558e8c8f1600a50ed96">THSParticle::PDG</a></div><div class="ttdeci">Int_t PDG()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00090">THSParticle.h:90</a></div></div>
<div class="ttc" id="THSParticle_8h_html"><div class="ttname"><a href="THSParticle_8h.html">THSParticle.h</a></div></div>
<div class="ttc" id="classTHSParticle_html_ae149932e9e58be94bd230b217631d3a4"><div class="ttname"><a href="classTHSParticle.html#ae149932e9e58be94bd230b217631d3a4">THSParticle::TruthP4</a></div><div class="ttdeci">TLorentzVector TruthP4()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00106">THSParticle.h:106</a></div></div>
<div class="ttc" id="classTHSParticle_html_a297a389a45e1fc05f5cf0b222d75956e"><div class="ttname"><a href="classTHSParticle.html#a297a389a45e1fc05f5cf0b222d75956e">THSParticle::Add</a></div><div class="ttdeci">void Add(THSParticle *hsp1, THSParticle *hsp2, Int_t pdg=0)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8C_source.html#l00040">THSParticle.C:40</a></div></div>
<div class="ttc" id="classTHSParticle_html_a98d3c77467bf58ca8ba47f3abb8349c5"><div class="ttname"><a href="classTHSParticle.html#a98d3c77467bf58ca8ba47f3abb8349c5">THSParticle::SetTime</a></div><div class="ttdeci">void SetTime(Double_t time)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00072">THSParticle.h:72</a></div></div>
<div class="ttc" id="THSParticle_8C_html_a244bae174c170ce22ff1bf918b39cbd2"><div class="ttname"><a href="THSParticle_8C.html#a244bae174c170ce22ff1bf918b39cbd2">ClassImp</a></div><div class="ttdeci">ClassImp(THSParticle)</div></div>
<div class="ttc" id="classTHSParticle_html_aab4b3a7a1171b5703dc74490b91203f0"><div class="ttname"><a href="classTHSParticle.html#aab4b3a7a1171b5703dc74490b91203f0">THSParticle::Path</a></div><div class="ttdeci">Double_t Path()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00097">THSParticle.h:97</a></div></div>
<div class="ttc" id="classTHSParticle_html_aa0c8643830ce0b97902d4c557b6a54e8"><div class="ttname"><a href="classTHSParticle.html#aa0c8643830ce0b97902d4c557b6a54e8">THSParticle::TruthVer</a></div><div class="ttdeci">TVector3 * TruthVer()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00107">THSParticle.h:107</a></div></div>
<div class="ttc" id="classTHSParticle_html_aa5a3c93b2752c427646ed98ce158ed33"><div class="ttname"><a href="classTHSParticle.html#aa5a3c93b2752c427646ed98ce158ed33">THSParticle::SetEdep</a></div><div class="ttdeci">void SetEdep(Double_t edep)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00075">THSParticle.h:75</a></div></div>
<div class="ttc" id="classTHSParticle_html_a3b8be65d9717d601277a7aa136706c0e"><div class="ttname"><a href="classTHSParticle.html#a3b8be65d9717d601277a7aa136706c0e">THSParticle::THSParticle</a></div><div class="ttdeci">THSParticle()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8C_source.html#l00015">THSParticle.C:15</a></div></div>
<div class="ttc" id="classTHSParticle_html_ab19db37973f622a19debdbfefb6606e8"><div class="ttname"><a href="classTHSParticle.html#ab19db37973f622a19debdbfefb6606e8">THSParticle::Edep</a></div><div class="ttdeci">Double_t Edep()</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00095">THSParticle.h:95</a></div></div>
<div class="ttc" id="classTHSParticle_html_a84d836fb5d7950c0481dea17137ed68b"><div class="ttname"><a href="classTHSParticle.html#a84d836fb5d7950c0481dea17137ed68b">THSParticle::SetVertex</a></div><div class="ttdeci">void SetVertex(TVector3 v)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00068">THSParticle.h:68</a></div></div>
<div class="ttc" id="classTHSParticle_html_a5d9e3be0f990518dd7435a8c2d70095c"><div class="ttname"><a href="classTHSParticle.html#a5d9e3be0f990518dd7435a8c2d70095c">THSParticle::SetPath</a></div><div class="ttdeci">void SetPath(Double_t path)</div><div class="ttdef"><b>Definition:</b> <a href="THSParticle_8h_source.html#l00073">THSParticle.h:73</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 10 2017 13:45:58 for HASPECT6 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
